<template>
    <div class="sandbox-container">
  
      <!-- 主要内容区域 -->
      <main class="main-content">
        <div class="file-info-container">
          <div class="file-icon-container">
            <div class="file-icon">
              <AlertOctagonIcon size="64" class="malware-icon" />
            </div>
            <div class="malware-label">恶意</div>
          </div>
  
          <div class="file-details">
            <h1 class="file-name">{{ fileInfo.fileName }}</h1>
  
            <div class="file-metadata">
              <div class="metadata-row">
                <div class="metadata-item">
                  <div class="metadata-label">首次提交：</div>
                  <div class="metadata-value">{{ fileInfo.firstSubmit }}</div>
                </div>
                <div class="metadata-item">
                  <div class="metadata-label">末次提交：</div>
                  <div class="metadata-value">{{ fileInfo.lastSubmit }}</div>
                </div>
                <div class="metadata-item">
                  <div class="metadata-label">末次分析：</div>
                  <div class="metadata-value">{{ fileInfo.lastAnalysis }}</div>
                </div>
              </div>
  
              <div class="metadata-row">
                <div class="metadata-item">
                  <div class="metadata-label">文件大小：</div>
                  <div class="metadata-value">{{ fileInfo.fileSize }}</div>
                </div>
                <div class="metadata-item">
                  <div class="metadata-label">文件类型：</div>
                  <div class="metadata-value">{{ fileInfo.fileType }}</div>
                </div>
              </div>
  
              <div class="metadata-row">
                <div class="metadata-item">
                  <div class="metadata-label">引擎检出：</div>
                  <div class="metadata-value">
                    <span class="detection-ratio">{{ fileInfo.detectionRatio }}</span>
                  </div>
                </div>
                <div class="metadata-item">
                  <div class="metadata-label">分析环境：</div>
                  <div class="metadata-value">
                    <span class="environment-tag">
                      <WindowsIcon size="14" />
                      {{ fileInfo.environment }}
                    </span>
                  </div>
                </div>
              </div>
  
              <div class="metadata-row">
                <div class="metadata-item">
                  <div class="metadata-label">威胁分类：</div>
                  <div class="metadata-value">
                    <span class="threat-tag">{{ fileInfo.threatType }}</span>
                    <HelpCircleIcon size="14" class="help-icon" />
                  </div>
                </div>
                <div class="metadata-item">
                  <div class="metadata-label">木马家族：</div>
                  <div class="metadata-value">
                    <span class="family-tag">
                      <ShieldAlertIcon size="14" />
                      {{ fileInfo.malwareFamily }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
  
            <div class="hash-section">
              <h3>HASH</h3>
              <div class="hash-row">
                <div class="hash-label">SHA256:</div>
                <div class="hash-value">{{ fileInfo.sha256 }}</div>
              </div>
              <div class="hash-row">
                <div class="hash-label">MD5:</div>
                <div class="hash-value">{{ fileInfo.md5 }}</div>
              </div>
              <div class="hash-row">
                <div class="hash-label">SHA1:</div>
                <div class="hash-value">{{ fileInfo.sha1 }}</div>
              </div>
            </div>
  
            <div class="action-buttons">
              <button class="action-btn" 
                @mouseenter="showDownloadHover = true"
                @mouseleave="showDownloadHover = false"
                :class="{ 'hover': showDownloadHover }"
              >
                <DownloadIcon size="16" />
                样本下载
              </button>
              <div class="dropdown-container" 
                @mouseenter="showDerivativeDropdown = true"
                @mouseleave="showDerivativeDropdown = false"
              >
                <button class="action-btn dropdown" :class="{ 'hover': showDerivativeDropdown }">
                  <FileTextIcon size="16" />
                  衍生文件
                  <ChevronDownIcon size="16" :class="{ 'rotate-180': showDerivativeDropdown }" />
                </button>
                <div class="dropdown-menu" v-show="showDerivativeDropdown">
                  <button class="dropdown-item">
                    <FileIcon size="16" />
                    PCAP
                  </button>
                  <button class="dropdown-item">
                    <FileIcon size="16" />
                    内存dump
                  </button>
                </div>
              </div>
              <div class="dropdown-container"
                @mouseenter="showReportDropdown = true"
                @mouseleave="showReportDropdown = false"
              >
                <button class="action-btn dropdown" :class="{ 'hover': showReportDropdown }">
                  <FileTextIcon size="16" />
                  报告下载
                  <ChevronDownIcon size="16" :class="{ 'rotate-180': showReportDropdown }" />
                </button>
                <div class="dropdown-menu" v-show="showReportDropdown">
                  <button class="dropdown-item">
                    <FileIcon size="16" />
                    PDF
                  </button>
                  <button class="dropdown-item">
                    <FileIcon size="16" />
                    JSON
                  </button>
                </div>
              </div>
              <button class="action-btn"
                @mouseenter="showAnalyzeHover = true"
                @mouseleave="showAnalyzeHover = false"
                :class="{ 'hover': showAnalyzeHover }"
              >
                <RefreshCwIcon size="16" />
                重新分析
              </button>
            </div>
          </div>
        </div>
  
        <!-- 分析结果标签页 -->
        <div class="analysis-tabs">
          <div class="sidebar">
            <div 
              v-for="(tab, index) in tabs" 
              :key="index" 
              class="sidebar-item" 
              :class="{ active: activeTab === index }"
              @click="activeTab = index"
            >
              <component :is="tab.icon" size="18" />
              <span>{{ tab.name }}</span>
            </div>
            <div class="environment-item">
              <WindowsIcon size="18" />
              <span>Win10(1903 64bi...</span>
              <ChevronDownIcon size="16" />
            </div>
          </div>
  
          <div class="tab-content">
            <!-- 情报IOC 标签页内容 -->
            <div v-if="activeTab === 0" class="ioc-section">
              <div class="section-header">
                <h3>情报IOC</h3>
                <HelpCircleIcon size="16" class="help-icon" />
              </div>
  
              <div class="ioc-table">
                <table>
                  <thead>
                    <tr>
                      <th>情报IOC</th>
                      <th>IOC类型</th>
                      <th>判定</th>
                      <th>情报内容</th>
                      <th>发现IOC环境</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="(ioc, index) in iocData" :key="index">
                      <td>{{ ioc.value }}</td>
                      <td>{{ ioc.type }}</td>
                      <td class="danger-text">{{ ioc.verdict }}</td>
                      <td>
                        <span 
                          v-for="(tag, tagIndex) in ioc.tags" 
                          :key="tagIndex" 
                          :class="tag.type === 'danger' ? 'danger-tag' : 'family-tag'"
                        >
                          <component v-if="tag.icon" :is="tag.icon" size="14" />
                          {{ tag.text }}
                        </span>
                      </td>
                      <td>
                        <span class="environment-tag">
                          <WindowsIcon size="14" />
                          {{ ioc.environment }}
                        </span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
  
            <!-- 行为检测标签页内容 -->
            <div v-if="activeTab === 1" class="detection-section">
              <!-- 高危行为 -->
              <div class="behavior-section" v-if="maliciousBehaviors.length > 0">
                <div class="section-header">
                  <div class="header-title">
                    <AlertOctagonIcon size="20" class="icon-danger" />
                    <h3>高危行为 ({{ maliciousBehaviors.length }})</h3>
                  </div>
                </div>
                <div class="behavior-list">
                  <div v-for="behavior in maliciousBehaviors" :key="behavior.name" class="behavior-item danger">
                    <div class="behavior-header" @click="toggleBehavior(behavior.name)">
                      <div class="behavior-title">
                        <span class="behavior-name">{{ JSON.parse(behavior.description).cn }}</span>
                        <span class="behavior-tag">{{ behavior.sigClassStr }}</span>
                        <span v-if="behavior.attck_id" class="attck-tag">
                          <ShieldAlertIcon size="14" />
                          {{ behavior.attck_id }}
                        </span>
                      </div>
                      <ChevronDownIcon 
                        size="20" 
                        :class="{ 'rotate-180': expandedBehaviors.includes(behavior.name) }" 
                      />
                    </div>
                    <div v-show="expandedBehaviors.includes(behavior.name)" class="behavior-details">
                      <div v-if="behavior.attck_info && Object.keys(behavior.attck_info).length > 0" class="attck-info">
                        <div class="attck-header">ATT&CK信息</div>
                        <div class="attck-content">
                          <div v-for="(value, key) in behavior.attck_info" :key="key" class="attck-item">
                            <span class="attck-label">{{ key }}:</span>
                            <span class="attck-value">{{ value }}</span>
                          </div>
                        </div>
                      </div>
                      <div class="marks-container">
                        <div v-for="(mark, index) in behavior.marks" :key="index" class="mark-item">
                          <template v-if="mark.type === 'ioc'">
                            <div class="mark-header">IOC信息</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">类型:</span>
                                <span class="field-value">{{ mark.ioc.category }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">值:</span>
                                <span class="field-value">{{ mark.ioc.ioc }}</span>
                              </div>
                              <div v-if="mark.ioc.pid && mark.ioc.pid.length > 0" class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.ioc.pid.join(', ') }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'call'">
                            <div class="mark-header">API调用</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">API:</span>
                                <span class="field-value">{{ mark.call.api }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.pid }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">参数:</span>
                                <span class="field-value">{{ JSON.stringify(mark.call.arguments) }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'generic'">
                            <div class="mark-header">通用信息</div>
                            <div class="mark-content">
                              <div v-if="mark.generic.file" class="mark-field">
                                <span class="field-label">文件名:</span>
                                <span class="field-value">{{ mark.generic.file.name }}</span>
                              </div>
                              <div v-if="mark.generic.parent_process" class="mark-field">
                                <span class="field-label">父进程:</span>
                                <span class="field-value">{{ mark.generic.parent_process }}</span>
                              </div>
                              <div v-if="mark.generic.martian_process" class="mark-field">
                                <span class="field-label">可疑进程:</span>
                                <span class="field-value">{{ mark.generic.martian_process }}</span>
                              </div>
                            </div>
                          </template>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
  
              <!-- 可疑行为 -->
              <div class="behavior-section" v-if="suspiciousBehaviors.length > 0">
                <div class="section-header">
                  <div class="header-title">
                    <AlertCircleIcon size="20" class="icon-warning" />
                    <h3>可疑行为 ({{ suspiciousBehaviors.length }})</h3>
                  </div>
                </div>
                <div class="behavior-list">
                  <div v-for="behavior in suspiciousBehaviors" :key="behavior.name" class="behavior-item warning">
                    <!-- 与高危行为相同的内部结构 -->
                    <div class="behavior-header" @click="toggleBehavior(behavior.name)">
                      <div class="behavior-title">
                        <span class="behavior-name">{{ JSON.parse(behavior.description).cn }}</span>
                        <span class="behavior-tag">{{ behavior.sigClassStr }}</span>
                        <span v-if="behavior.attck_id" class="attck-tag">
                          <ShieldAlertIcon size="14" />
                          {{ behavior.attck_id }}
                        </span>
                      </div>
                      <ChevronDownIcon 
                        size="20" 
                        :class="{ 'rotate-180': expandedBehaviors.includes(behavior.name) }" 
                      />
                    </div>
                    <!-- 展开的详细信息部分与高危行为相同 -->
                    <div v-show="expandedBehaviors.includes(behavior.name)" class="behavior-details">
                      <!-- 与高危行为相同的详情结构 -->
                      <div v-if="behavior.attck_info && Object.keys(behavior.attck_info).length > 0" class="attck-info">
                        <div class="attck-header">ATT&CK信息</div>
                        <div class="attck-content">
                          <div v-for="(value, key) in behavior.attck_info" :key="key" class="attck-item">
                            <span class="attck-label">{{ key }}:</span>
                            <span class="attck-value">{{ value }}</span>
                          </div>
                        </div>
                      </div>
                      <div class="marks-container">
                        <!-- 与高危行为相同的marks结构 -->
                        <div v-for="(mark, index) in behavior.marks" :key="index" class="mark-item">
                          <template v-if="mark.type === 'ioc'">
                            <div class="mark-header">IOC信息</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">类型:</span>
                                <span class="field-value">{{ mark.ioc.category }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">值:</span>
                                <span class="field-value">{{ mark.ioc.ioc }}</span>
                              </div>
                              <div v-if="mark.ioc.pid && mark.ioc.pid.length > 0" class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.ioc.pid.join(', ') }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'call'">
                            <div class="mark-header">API调用</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">API:</span>
                                <span class="field-value">{{ mark.call.api }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.pid }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">参数:</span>
                                <span class="field-value">{{ JSON.stringify(mark.call.arguments) }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'generic'">
                            <div class="mark-header">通用信息</div>
                            <div class="mark-content">
                              <div v-if="mark.generic.file" class="mark-field">
                                <span class="field-label">文件名:</span>
                                <span class="field-value">{{ mark.generic.file.name }}</span>
                              </div>
                              <div v-if="mark.generic.parent_process" class="mark-field">
                                <span class="field-label">父进程:</span>
                                <span class="field-value">{{ mark.generic.parent_process }}</span>
                              </div>
                              <div v-if="mark.generic.martian_process" class="mark-field">
                                <span class="field-label">可疑进程:</span>
                                <span class="field-value">{{ mark.generic.martian_process }}</span>
                              </div>
                            </div>
                          </template>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
  
              <!-- 一般行为 -->
              <div class="behavior-section" v-if="generalBehaviors.length > 0">
                <div class="section-header">
                  <div class="header-title">
                    <InfoIcon size="20" class="icon-info" />
                    <h3>一般行为 ({{ generalBehaviors.length }})</h3>
                  </div>
                </div>
                <div class="behavior-list">
                  <div v-for="behavior in generalBehaviors" :key="behavior.name" class="behavior-item info">
                    <!-- 与高危行为相同的内部结构 -->
                    <div class="behavior-header" @click="toggleBehavior(behavior.name)">
                      <div class="behavior-title">
                        <span class="behavior-name">{{ JSON.parse(behavior.description).cn }}</span>
                        <span class="behavior-tag">{{ behavior.sigClassStr }}</span>
                        <span v-if="behavior.attck_id" class="attck-tag">
                          <ShieldAlertIcon size="14" />
                          {{ behavior.attck_id }}
                        </span>
                      </div>
                      <ChevronDownIcon 
                        size="20" 
                        :class="{ 'rotate-180': expandedBehaviors.includes(behavior.name) }" 
                      />
                    </div>
                    <!-- 展开的详细信息部分与高危行为相同 -->
                    <div v-show="expandedBehaviors.includes(behavior.name)" class="behavior-details">
                      <!-- 与高危行为相同的详情结构 -->
                      <div v-if="behavior.attck_info && Object.keys(behavior.attck_info).length > 0" class="attck-info">
                        <div class="attck-header">ATT&CK信息</div>
                        <div class="attck-content">
                          <div v-for="(value, key) in behavior.attck_info" :key="key" class="attck-item">
                            <span class="attck-label">{{ key }}:</span>
                            <span class="attck-value">{{ value }}</span>
                          </div>
                        </div>
                      </div>
                      <div class="marks-container">
                        <!-- 与高危行为相同的marks结构 -->
                        <div v-for="(mark, index) in behavior.marks" :key="index" class="mark-item">
                          <template v-if="mark.type === 'ioc'">
                            <div class="mark-header">IOC信息</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">类型:</span>
                                <span class="field-value">{{ mark.ioc.category }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">值:</span>
                                <span class="field-value">{{ mark.ioc.ioc }}</span>
                              </div>
                              <div v-if="mark.ioc.pid && mark.ioc.pid.length > 0" class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.ioc.pid.join(', ') }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'call'">
                            <div class="mark-header">API调用</div>
                            <div class="mark-content">
                              <div class="mark-field">
                                <span class="field-label">API:</span>
                                <span class="field-value">{{ mark.call.api }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">进程ID:</span>
                                <span class="field-value">{{ mark.pid }}</span>
                              </div>
                              <div class="mark-field">
                                <span class="field-label">参数:</span>
                                <span class="field-value">{{ JSON.stringify(mark.call.arguments) }}</span>
                              </div>
                            </div>
                          </template>
                          <template v-else-if="mark.type === 'generic'">
                            <div class="mark-header">通用信息</div>
                            <div class="mark-content">
                              <div v-if="mark.generic.file" class="mark-field">
                                <span class="field-label">文件名:</span>
                                <span class="field-value">{{ mark.generic.file.name }}</span>
                              </div>
                              <div v-if="mark.generic.parent_process" class="mark-field">
                                <span class="field-label">父进程:</span>
                                <span class="field-value">{{ mark.generic.parent_process }}</span>
                              </div>
                              <div v-if="mark.generic.martian_process" class="mark-field">
                                <span class="field-label">可疑进程:</span>
                                <span class="field-value">{{ mark.generic.martian_process }}</span>
                              </div>
                            </div>
                          </template>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- 引擎检测 标签页内容 -->
            <div v-if="activeTab === 3" class="engine-detection">
              <div class="detection-header">
                <h3>多引擎检测</h3>
                <div class="detection-summary">
                  <span class="detection-ratio">检出率：{{ engineData.report_num }}/{{ engineData.total }}</span>
                  <span class="detection-time">最近检测时间：{{ engineData.recent_scan }}</span>
                </div>
              </div>
  
              <div class="engine-grid">
                <div v-for="(engine, index) in displayEngines" :key="index" class="engine-item">
                  <div class="engine-name">{{ engine.engine_desc }}</div>
                  <div class="engine-result" :class="{ 'is-malicious': engine.result !== 'safe' }">
                    <AlertCircleIcon v-if="engine.result !== 'safe'" size="14" class="alert-icon" />
                    {{ engine.result }}
                  </div>
                </div>
              </div>
  
              <div v-if="engineData.engine_result.length > 4" class="show-more" @click="showAllEngines = !showAllEngines">
                <span>{{ showAllEngines ? '收起' : '查看全部' }}</span>
                <ChevronDownIcon :class="{ 'rotate-180': showAllEngines }" size="16" />
              </div>
            </div>
  
            <!-- 静态分析 标签页内容 -->
            <div v-if="activeTab === 4" class="static-analysis">
              <!-- 基本信息 -->
              <div class="analysis-section">
                <div class="section-header-with-icon">
                  <FileIcon size="20" />
                  <h3 class="section-title">基本信息</h3>
                </div>
                <div class="info-grid">
                  <div v-for="(value, key) in staticData.baseInfo" :key="key" class="info-item">
                    <span class="info-label">{{ key }}：</span>
                    <span class="info-value">{{ value }}</span>
                    <div class="info-divider"></div>
                  </div>
                </div>
              </div>
  
              <!-- PE头信息 -->
              <div class="analysis-section">
                <div class="section-header-with-icon">
                  <DatabaseIcon size="20" />
                  <h3 class="section-title">PE头信息</h3>
                </div>
                <div class="info-grid">
                  <div v-for="(value, key) in staticData.pe.headMap" :key="key" class="info-item">
                    <span class="info-label">{{ key }}：</span>
                    <span class="info-value">{{ value }}</span>
                    <div class="info-divider"></div>
                  </div>
                </div>
              </div>
  
              <!-- PE节区 -->
              <div class="analysis-section">
                <div class="section-header-with-icon">
                  <LayersIcon size="20" />
                  <h3 class="section-title">PE节区</h3>
                </div>
                <div class="sections-table-container">
                  <table class="sections-table">
                    <thead>
                      <tr>
                        <th>节区名</th>
                        <th>虚拟地址</th>
                        <th>虚拟大小</th>
                        <th>原始大小</th>
                        <th>权限</th>
                        <th>熵值</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr v-for="section in staticData.pe.sectionsMap" :key="section.name">
                        <td>{{ section.name }}</td>
                        <td>{{ section.virtual_address }}</td>
                        <td>{{ section.virtual_size }}</td>
                        <td>{{ section.size_of_data }}</td>
                        <td>{{ section.SectionPermission }}</td>
                        <td>{{ section.entropy.toFixed(2) }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
  
              <!-- 导入表 -->
              <div class="analysis-section">
                <div class="section-header-with-icon">
                  <FolderTreeIcon size="20" />
                  <h3 class="section-title">导入表</h3>
                </div>
                <div class="imports-container">
                  <table class="imports-table">
                    <thead>
                      <tr>
                        <th>DLL名称</th>
                        <th>函数数量</th>
                        <th>操作</th>
                      </tr>
                    </thead>
                    <tbody>
                      <template v-for="imp in staticData.pe.importsMap" :key="imp.dll">
                        <tr>
                          <td>
                            <div class="dll-name">
                              <FileIcon size="16" />
                              <span>{{ imp.dll }}</span>
                            </div>
                          </td>
                          <td>{{ imp.count }}</td>
                          <td>
                            <button 
                              class="expand-btn" 
                              @click="toggleDllDetails(imp.dll)"
                              :class="{ 'expanded': expandedDlls.includes(imp.dll) }"
                            >
                              <ChevronDownIcon size="16" />
                            </button>
                          </td>
                        </tr>
                        <tr v-show="expandedDlls.includes(imp.dll)" class="details-row">
                          <td colspan="3" class="function-details">
                            <div class="function-list">
                              <div v-for="func in imp.imports" :key="func.address" class="function-item">
                                <span class="function-address">{{ func.address }}</span>
                                <span class="function-name">{{ func.name }}</span>
                              </div>
                            </div>
                          </td>
                        </tr>
                      </template>
                    </tbody>
                  </table>
                </div>
              </div>
  
              <!-- 字符串 -->
              <div class="analysis-section">
                <div class="section-header-with-icon">
                  <TextIcon size="20" />
                  <h3 class="section-title">字符串</h3>
                </div>
                <div class="strings-container">
                  <div class="strings-tabs">
                    <button 
                      :class="{ active: activeStringTab === 'ASCII' }" 
                      @click="activeStringTab = 'ASCII'"
                    >ASCII</button>
                    <button 
                      :class="{ active: activeStringTab === 'Unicode' }" 
                      @click="activeStringTab = 'Unicode'"
                    >Unicode</button>
                  </div>
                  <div class="strings-content">
                    <div v-for="str in staticData.pe.fileMap.strings[activeStringTab]" :key="str" class="string-item">
                      {{ str }}
                      <div class="string-divider"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- 多维检测标签页内容 -->
            <div v-if="activeTab === 2" class="detection-section">
              <!-- Yara规则 -->
              <div class="section-header">
                <h3>Yara规则</h3>
              </div>
              <div class="yara-table-container">
                <table class="sigma-table">
                  <thead>
                    <tr>
                      <th>规则名称</th>
                      <th>描述</th>
                      <th>匹配项</th>
                      <th>源</th>
                      <th>分析环境</th>
                    </tr>
                  </thead>
                  <tbody>
                    <template v-for="rule in yaraRules.merged.tsmam" :key="rule.name">
                      <tr>
                        <td>{{ rule.name }}</td>
                        <td>{{ rule.description || '无描述' }}</td>
                        <td>
                          <button class="matches-btn" @click="toggleYaraMatches(rule.name)">
                            {{ rule.matches.length }} 条匹配
                            <ChevronDownIcon 
                              size="14" 
                              :class="{ 'rotate-180': expandedYaraMatches.includes(rule.name) }" 
                            />
                          </button>
                        </td>
                        <td>{{ rule.source }}</td>
                        <td>
                          <div class="environment-tags">
                            <span v-for="env in rule.sandboxType" :key="env" class="environment-tag">
                              <WindowsIcon size="14" />
                              {{ env }}
                            </span>
                          </div>
                        </td>
                      </tr>
                      <!-- 匹配项详情行 -->
                      <tr v-show="expandedYaraMatches.includes(rule.name)" class="matches-row">
                        <td colspan="5">
                          <div class="matches-details">
                            <div class="match-item">
                              <div class="match-header">匹配字符串</div>
                              <div class="match-content">
                                <div v-for="match in rule.matches" :key="match" class="match-field">
                                  <span class="field-value">{{ match }}</span>
                                </div>
                              </div>
                            </div>
                            <div class="match-item">
                              <div class="match-header">文件路径</div>
                              <div class="match-content">
                                <div class="match-field">
                                  <span class="field-value">{{ rule.path }}</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
  
              <!-- Sigma规则 -->
              <div class="section-header">
                <h3>Sigma规则</h3>
              </div>
              <div class="sigma-table-container">
                <table class="sigma-table">
                  <thead>
                    <tr>
                      <th>标题</th>
                      <th>描述</th>
                      <th>标签</th>
                      <th>危险等级</th>
                      <th>匹配项</th>
                      <th>源</th>
                      <th>分析环境</th>
                    </tr>
                  </thead>
                  <tbody>
                    <template v-for="rule in sigmaRules.merged" :key="rule.title">
                      <tr>
                        <td>{{ rule.title }}</td>
                        <td>{{ rule.description }}</td>
                        <td>
                          <div class="tags-container">
                            <span v-for="tag in rule.tags" :key="tag" class="tag">
                              {{ tag }}
                            </span>
                          </div>
                        </td>
                        <td>
                          <span :class="['level-tag', rule.level]">{{ rule.level }}</span>
                        </td>
                        <td>
                          <button class="matches-btn" @click="toggleMatches(rule.title)">
                            {{ rule.matches.length }} 条匹配
                            <ChevronDownIcon 
                              size="14" 
                              :class="{ 'rotate-180': expandedMatches.includes(rule.title) }" 
                            />
                          </button>
                        </td>
                        <td>{{ rule.source }}</td>
                        <td>
                          <div class="environment-tags">
                            <span v-for="env in rule.sandboxType" :key="env" class="environment-tag">
                              <WindowsIcon size="14" />
                              {{ env }}
                            </span>
                          </div>
                        </td>
                      </tr>
                      <!-- 匹配项详情行 -->
                      <tr v-show="expandedMatches.includes(rule.title)" class="matches-row">
                        <td colspan="7">
                          <div class="matches-details">
                            <div v-for="match in rule.matches" :key="match.row_id" class="match-item">
                              <div class="match-header">事件 ID: {{ match.EventID }}</div>
                              <div class="match-content">
                                <div class="match-field">
                                  <span class="field-label">进程:</span>
                                  <span class="field-value">{{ match.Image }}</span>
                                </div>
                                <div class="match-field">
                                  <span class="field-label">命令行:</span>
                                  <span class="field-value">{{ match.CommandLine || match.TargetObject || '-' }}</span>
                                </div>
                                <div class="match-field">
                                  <span class="field-label">时间:</span>
                                  <span class="field-value">{{ match.UtcTime }}</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </template>
  
  <script setup>
  import { ref, computed, onMounted } from 'vue'
  import { useRoute } from 'vue-router'
  import { getSample } from '@/api/samples'
  import { ElMessage } from 'element-plus'
  import { 
    Search as SearchIcon, 
    Filter as FilterIcon,
    AlertOctagon as AlertOctagonIcon,
    HelpCircle as HelpCircleIcon,
    ShieldAlert as ShieldAlertIcon,
    Download as DownloadIcon,
    FileText as FileTextIcon,
    RefreshCw as RefreshCwIcon,
    ChevronDown as ChevronDownIcon,
    Activity as ActivityIcon,
    Layers as LayersIcon,
    Link as LinkIcon,
    PauseCircle as PauseCircleIcon,
    PlayCircle as PlayCircleIcon,
    AlertCircle as AlertCircleIcon,
    Monitor as WindowsIcon,
    File as FileIcon,
    Database as DatabaseIcon,
    FolderTree as FolderTreeIcon,
    Text as TextIcon,
    Info as InfoIcon,
  } from 'lucide-vue-next'
  
  const route = useRoute()
  const sha256 = route.params.sha256
  
  // 模拟数据
  const fileInfo = ref({
    fileName: '26c46fdf058abdf2d4cad1d8bcca0d686c1aa556...dc7ba1.zip',
    firstSubmit: '2025/04/10',
    lastSubmit: '2025/04/10',
    lastAnalysis: '2025/04/10 11:54:22',
    fileSize: '564.87 KB',
    fileType: 'Zip archive data, at least v2.0 to extract',
    detectionRatio: '8 / 28',
    environment: 'Win10(1903 64bit,Office2016)',
    threatType: '木马',
    malwareFamily: 'AutoIt',
    sha256: '13e69bf725e206a1129ddc5bd069f3298a0b0d3c92fe8fc5647c4471b1164bb2',
    md5: '23f38b4faf93cd3013007d90a712f4ef',
    sha1: 'dd9edcf2585d2c843151a8705e695e46a87d18e1'
  })
  
  // 标签页数据
  const tabs = [
    { name: '情报IOC', icon: FileTextIcon },
    { name: '行为检测', icon: ActivityIcon },
    { name: '多维检测', icon: LayersIcon },
    { name: '引擎检测', icon: LinkIcon },
    { name: '静态分析', icon: PauseCircleIcon },
    { name: '动态分析', icon: PlayCircleIcon }
  ]
  
  const activeTab = ref(0)
  
  // IOC数据
  const iocData = [
    {
      value: 'boyonnem.ddns.net',
      type: 'Domain',
      verdict: '恶意',
      tags: [
        { text: '恶意软件', type: 'danger' },
        { text: '远控', type: 'danger' },
        { text: 'Cryptinject木马', type: 'danger', icon: FileTextIcon },
        { text: 'Noancode黑客工具', type: 'danger', icon: FileTextIcon }
      ],
      environment: 'Win10(1903 64bit,Office2016)'
    },
    {
      value: '13e69bf725e206a1129ddc5bd069f3298a0b0d3c92fe8fc5647c4471b1164bb2',
      type: 'Hash',
      verdict: '恶意',
      tags: [
        { text: 'AutoIt', type: 'family', icon: ShieldAlertIcon },
        { text: '木马', type: 'danger' }
      ],
      environment: 'Win10(1903 64bit,Office2016)'
    }
  ]
  
  // 高危行为数据
  const highRisks = [
    {
      title: '创建自启动项',
      description: '恶意程序通过修改注册表创建自启动项，实现系统重启后自动运行'
    },
    {
      title: '窃取用户凭证',
      description: '恶意程序尝试获取系统中存储的用户名和密码信息'
    },
    {
      title: '远程连接控制',
      description: '恶意程序建立与远程服务器的连接，可能用于数据窃取或远程控制'
    }
  ]
  
  // 行为检测
  const behaviorDetection = ref([
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Invoke COM-related apis\", \"cn\": \"调用COM相关API\"}",
              "families": [],
              "markcount": 2,
              "marks": [
                  {
                      "type": "generic",
                      "generic": {
                          "clasid": "{00000339-0000-0000-c000-000000000046}",
                          "api": "CoCreateInstance",
                          "iid": "{00000003-0000-0000-c000-000000000046}"
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "clasid": "{c2f03a33-21f5-47fa-b4bb-156362a2f239}",
                          "api": "CoCreateInstance",
                          "iid": "{6d5140c1-7436-11ce-8034-00aa006009fa}"
                      }
                  }
              ],
              "name": "com_relation_api_call",
              "references": [],
              "severity": 1,
              "sig_class": "System Sensitive operation",
              "level": 1,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "general",
              "sigClassStr": "系统敏感操作"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Creates a writable file in a temporary directory\", \"cn\": \"在临时目录中创建文件\"}",
              "families": [],
              "markcount": 6,
              "marks": [
                  {
                      "call": {
                          "tid": 6920,
                          "time": 1.744088843075871E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x000002a4",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEM51D4.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 6916,
                      "type": "call",
                      "cid": 21
                  },
                  {
                      "call": {
                          "tid": 6296,
                          "time": 1.7440888505460703E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x000002a8",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEMAD71.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 6300,
                      "type": "call",
                      "cid": 20
                  },
                  {
                      "call": {
                          "tid": 4828,
                          "time": 1.7440888422022695E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x0000028c",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEM5D2.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 4840,
                      "type": "call",
                      "cid": 21
                  },
                  {
                      "call": {
                          "tid": 6948,
                          "time": 1.7440889430626914E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x00000264",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEM5F5C.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 6956,
                      "type": "call",
                      "cid": 20
                  },
                  {
                      "call": {
                          "tid": 3104,
                          "time": 1.74408890395242E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x00000294",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEMB888.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 672,
                      "type": "call",
                      "cid": 22
                  },
                  {
                      "call": {
                          "tid": 3172,
                          "time": 1.7440889103272754E12,
                          "api": "NtCreateFile",
                          "category": "file",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "file_handle": "0x000002a8",
                              "desired_access": "0x40100080",
                              "file_attributes": 128,
                              "create_disposition": 5,
                              "create_options": 96,
                              "share_access": 3,
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMFEF.exe",
                              "filepath_r": "\\??\\C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\DEMFEF.exe",
                              "status_info": 2
                          },
                          "flags": {
                              "create_disposition": "FILE_OVERWRITE_IF",
                              "status_info": "FILE_CREATED",
                              "desired_access": "FILE_READ_ATTRIBUTES|SYNCHRONIZE|GENERIC_WRITE",
                              "file_attributes": "FILE_ATTRIBUTE_NORMAL",
                              "share_access": "FILE_SHARE_READ|FILE_SHARE_WRITE",
                              "create_options": "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                          },
                          "stacktrace": []
                      },
                      "pid": 3160,
                      "type": "call",
                      "cid": 22
                  }
              ],
              "name": "create_file_intemp",
              "references": [],
              "severity": 1,
              "sig_class": "General",
              "level": 3,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "general",
              "sigClassStr": "一般行为"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Creates executable files on the filesystem\", \"cn\": \"在文件系统上创建可执行文件\"}",
              "families": [],
              "markcount": 6,
              "marks": [
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6300,
                              4840
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6916,
                              6300
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6956,
                              672
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              4840,
                              6956
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              672,
                              3160
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              3160
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMFEF.exe"
                      }
                  }
              ],
              "name": "creates_exe",
              "references": [],
              "severity": 1,
              "sig_class": "System Sensitive operation",
              "level": 1,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "general",
              "sigClassStr": "系统敏感操作"
          },
          {
              "attck_id": "T1082",
              "attck_info": {
                  "title": "System Information Discovery",
                  "Permissions Required": "User",
                  "Platform": "Linux, macOS, Windows",
                  "Data Sources": "Process command-line parameters, Process monitoring",
                  "Tactic": "Discovery",
                  "CAPEC ID": "CAPEC-311",
                  "ID": "T1082"
              },
              "description": "{\"en\": \"Contains functionality to query system information\", \"cn\": \"获取系统信息\"}",
              "families": [],
              "markcount": 5,
              "marks": [
                  {
                      "call": {
                          "tid": 6192,
                          "time": 1.744110624075871E12,
                          "api": "GetSystemInfo",
                          "category": "system",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "processor_count": 4
                          },
                          "flags": {},
                          "stacktrace": []
                      },
                      "pid": 6916,
                      "type": "call",
                      "cid": 340
                  },
                  {
                      "call": {
                          "tid": 4832,
                          "time": 1.7441104755460703E12,
                          "api": "GetSystemInfo",
                          "category": "system",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "processor_count": 4
                          },
                          "flags": {},
                          "stacktrace": []
                      },
                      "pid": 6300,
                      "type": "call",
                      "cid": 339
                  },
                  {
                      "call": {
                          "tid": 6884,
                          "time": 1.7441106552022695E12,
                          "api": "GetSystemInfo",
                          "category": "system",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "processor_count": 4
                          },
                          "flags": {},
                          "stacktrace": []
                      },
                      "pid": 4840,
                      "type": "call",
                      "cid": 340
                  },
                  {
                      "call": {
                          "tid": 1928,
                          "time": 1.7441106300626914E12,
                          "api": "GetSystemInfo",
                          "category": "system",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "processor_count": 4
                          },
                          "flags": {},
                          "stacktrace": []
                      },
                      "pid": 6956,
                      "type": "call",
                      "cid": 340
                  },
                  {
                      "call": {
                          "tid": 7032,
                          "time": 1.74411040395242E12,
                          "api": "GetSystemInfo",
                          "category": "system",
                          "status": 1,
                          "return_value": 0,
                          "arguments": {
                              "processor_count": 4
                          },
                          "flags": {},
                          "stacktrace": []
                      },
                      "pid": 672,
                      "type": "call",
                      "cid": 342
                  }
              ],
              "name": "getsysteminfo",
              "references": [],
              "severity": 1,
              "sig_class": "Environment Awareness",
              "level": 8,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "general",
              "sigClassStr": "系统环境探测"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"This executable has a PDB path\", \"cn\": \"这个可执行文件存在调试数据库文件（PDB）路径\"}",
              "families": [],
              "markcount": 1,
              "marks": [
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [],
                          "category": "pdb_path",
                          "ioc": "C:\\ping_pong\\win_client\\Release\\win_client.pdb"
                      }
                  }
              ],
              "name": "has_pdb",
              "references": [],
              "severity": 1,
              "sig_class": "General",
              "level": 3,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "general",
              "sigClassStr": "一般行为"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Drops a binary and executes it\", \"cn\": \"释放了一个二进制文件并执行\"}",
              "families": [],
              "markcount": 5,
              "marks": [
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6916,
                              6300
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6300,
                              4840
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              4840,
                              6956
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6956,
                              672
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              672,
                              3160
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe"
                      }
                  }
              ],
              "name": "dropper",
              "references": [],
              "severity": 2,
              "sig_class": "General",
              "level": 3,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "suspicious",
              "sigClassStr": "一般行为"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"One or more martian processes was created\", \"cn\": \"创建一个或多个可疑进程\"}",
              "families": [],
              "markcount": 5,
              "marks": [
                  {
                      "type": "generic",
                      "generic": {
                          "parent_process": "8038e5.exe",
                          "martian_process": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe"
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "parent_process": "dem51d4.exe",
                          "martian_process": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe"
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "parent_process": "demad71.exe",
                          "martian_process": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe"
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "parent_process": "dem5d2.exe",
                          "martian_process": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe"
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "parent_process": "dem5f5c.exe",
                          "martian_process": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe"
                      }
                  }
              ],
              "name": "process_martian",
              "references": [],
              "severity": 2,
              "sig_class": "System Sensitive operation",
              "level": 1,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "suspicious",
              "sigClassStr": "系统敏感操作"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Creates an executable file in a user folder\", \"cn\": \"在用户目录下创建可执行文件\"}",
              "families": [
                  "persistance"
              ],
              "markcount": 6,
              "marks": [
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6916,
                              6300
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6300,
                              4840
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              4840,
                              6956
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              6956,
                              672
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              672,
                              3160
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe"
                      }
                  },
                  {
                      "type": "ioc",
                      "ioc": {
                          "pid": [
                              3160
                          ],
                          "category": "file",
                          "ioc": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMFEF.exe"
                      }
                  }
              ],
              "name": "creates_user_folder_exe",
              "references": [],
              "severity": 3,
              "sig_class": "System Sensitive operation",
              "level": 1,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "malicious",
              "sigClassStr": "系统敏感操作"
          },
          {
              "attck_id": "",
              "attck_info": {},
              "description": "{\"en\": \"Creates a slightly modified copy of itself\", \"cn\": \"创建一个微改过的拷贝\"}",
              "families": [],
              "markcount": 6,
              "marks": [
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEM51D4.exe",
                              "path": "files/551ba0f0ef687b10afb7976341d908789486f01b472d509011bb59739d350cb8/DEM51D4.exe",
                              "size": 14912,
                              "crc32": "8656F7DD",
                              "md5": "31981faea6e052969540e172057f1e28",
                              "sha1": "ca9279b53e2e4ed908e6888ae63b5de179479705",
                              "sha256": "551ba0f0ef687b10afb7976341d908789486f01b472d509011bb59739d350cb8",
                              "sha512": "44468f7f7141bb3c20be4dd57bb7064879d995dcdd1cbc4c688adb96d5c51d048292475b6e747d0381a5a3b2df0f9153d6d386afc9db0fb42a00ce1ed3a9daa5",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYEM:hDXWipuE+K3/SSHgxmX",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  6916
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM51D4.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\dem51d4.exe"
                              ],
                              "download": []
                          }
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEMAD71.exe",
                              "path": "files/abb3f5a65efa08126c98abcd7ad85c42c8cb75a87c534f4bbcb808c90acd35e5/DEMAD71.exe",
                              "size": 14928,
                              "crc32": "8E80FD6A",
                              "md5": "0ebee36a8ceda3e9115b519d96a407a1",
                              "sha1": "f23ccf6990f109b836b5bea791c4ba8f90fd0184",
                              "sha256": "abb3f5a65efa08126c98abcd7ad85c42c8cb75a87c534f4bbcb808c90acd35e5",
                              "sha512": "c33dd6910bd85347e6b8e6b430a2fed20b0a75b624f0f0ec9c3ed50047b0eed143fc7b6c2f6b2aa8eaeb55a55830f2201b4c2110b4632dd5cf5ef860930e875c",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYEY:hDXWipuE+K3/SSHgxm3",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  6300
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMAD71.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\demad71.exe"
                              ],
                              "download": []
                          }
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEM5D2.exe",
                              "path": "files/bb25ae27043c87f776464f0be6a6a16a70492b0387a2a826e5e6ec135440c9d6/DEM5D2.exe",
                              "size": 14944,
                              "crc32": "F3B65C62",
                              "md5": "b451e69aba2b4663d2e2532f82fe2556",
                              "sha1": "4efb8c72472a9b37d29e7424f9a2b13f8710101c",
                              "sha256": "bb25ae27043c87f776464f0be6a6a16a70492b0387a2a826e5e6ec135440c9d6",
                              "sha512": "def321a89a5f5d9273c1cf240d03c30250ac1ab0c9b8a61b80798adf4c4169f545563b718d00373166a31f9f36c745f33848633f9ae84bbb7012514815899f7f",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYEm:hDXWipuE+K3/SSHgxmp",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  4840
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5D2.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\dem5d2.exe"
                              ],
                              "download": []
                          }
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEM5F5C.exe",
                              "path": "files/56995ea483efed80ce3ebfa5f614b35125ef05579e9521dd73231c9882f10a84/DEM5F5C.exe",
                              "size": 14960,
                              "crc32": "B8485951",
                              "md5": "d3028702a28ccc7306c643bbeaeeac70",
                              "sha1": "7538fbbe0afdde8880ebf9131ddc603e35a021c2",
                              "sha256": "56995ea483efed80ce3ebfa5f614b35125ef05579e9521dd73231c9882f10a84",
                              "sha512": "dee563c75427a5151095a081bbd3df03f3afea3b9195b7ad3fbbc23e0f5a8ac8a8778f438100b0b2c03f0a2bbdc661c99ad9fb0bdfcf929fe798bacb8c7a79c5",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYE1:hDXWipuE+K3/SSHgxm2",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  6956
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEM5F5C.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\dem5f5c.exe"
                              ],
                              "download": []
                          }
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEMB888.exe",
                              "path": "files/8cc354b4cb649e7380b142dc99bddbfb1c60fedc04b8d8a8ecfc800e4987b58f/DEMB888.exe",
                              "size": 14976,
                              "crc32": "2FD8F122",
                              "md5": "c59b2ca064d697151bddd808796bd60a",
                              "sha1": "f290b507a00d20ba53014376cdb7a7782b8f5526",
                              "sha256": "8cc354b4cb649e7380b142dc99bddbfb1c60fedc04b8d8a8ecfc800e4987b58f",
                              "sha512": "f59c38541a5132f2042d20f18e97ae001c02bcade51be1e0a98c6a3db738173bf8a5579b1d8074c491d828381aceea35a378fecce297fe54425330fb99d43048",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYET:hDXWipuE+K3/SSHgxm8",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  672
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMB888.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\demb888.exe"
                              ],
                              "download": []
                          }
                      }
                  },
                  {
                      "type": "generic",
                      "generic": {
                          "file": {
                              "name": "DEMFEF.exe",
                              "path": "files/35f18c3d0299bd98e3b3104a7ef274b15f825da20cc2a7160205a93c011adc52/DEMFEF.exe",
                              "size": 14992,
                              "crc32": "3E33CA7A",
                              "md5": "3290fbc1f2b9df79bc98a52017b3b576",
                              "sha1": "c8a639855fa9ff4d57f8f642c6347fa444be128c",
                              "sha256": "35f18c3d0299bd98e3b3104a7ef274b15f825da20cc2a7160205a93c011adc52",
                              "sha512": "28553b90bbbbb28f0f1aa4c63d143b5143eb2df0269d8c8c7cfb0bdf3f7d15c83ae82e9c004f57540bf362e3d0d1b0568494da2d48212025817a05db2de7468c",
                              "ssdeep": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYEe:hDXWipuE+K3/SSHgxmh",
                              "type": "PE32 executable (console) Intel 80386, for MS Windows",
                              "yara": [],
                              "domains": [],
                              "ips": [],
                              "urls": [],
                              "mails": [],
                              "pids": [
                                  3160
                              ],
                              "filepath": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\DEMFEF.exe",
                              "create_type": "CLOSE",
                              "paths": [
                                  "c:\\users\\administrator\\appdata\\local\\temp\\demfef.exe"
                              ],
                              "download": []
                          }
                      }
                  }
              ],
              "name": "packer_polymorphic",
              "references": [],
              "severity": 3,
              "sig_class": "General",
              "level": 3,
              "sandboxType": "Win10(1903 64bit,Office2016)",
              "severityStr": "malicious",
              "sigClassStr": "一般行为"
          }
      ])
  
  // 多维检测数据
  // yara
  const yaraRules = ref({
          "grouped": {
              "tsmam": {
                  "Win10(1903 64bit,Office2016)": [
                      {
                          "name": "suspicious_packer_section",
                          "description": "The packer/protector section names/keywords",
                          "sha256": null,
                          "path": "b6455d6e9a931e2c_7504_5969047944310442025",
                          "matches": [
                              "UPX!",
                              "UPX0",
                              "UPX1"
                          ],
                          "source": "Github",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "UPX",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "b6455d6e9a931e2c_7504_5969047944310442025",
                          "matches": [
                              "UPX!",
                              "UPX0",
                              "UPX1"
                          ],
                          "source": "Github",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "shellcode",
                          "description": "Matched shellcode byte patterns",
                          "sha256": null,
                          "path": "fd4909a0d0e51318_7504_939301044310442025",
                          "matches": [
                              "558bec81ec",
                              "648b3530"
                          ],
                          "source": "General",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "NanoCore",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "ClientPlugin",
                              "LogClientMessage",
                              "NanoCore",
                              "ProjectData"
                          ],
                          "source": "General",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "NanoCore_1",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "#=q",
                              "ClientPlugin",
                              "DESCrypto",
                              "KeepAlive",
                              "LogClientMessage",
                              "NanoCore",
                              "ProjectData",
                              "get_Connected"
                          ],
                          "source": "General",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "MALWARE_Win_NanoCore",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "ClientPlugin",
                              "EndPoint",
                              "IClientNameObjectCollection",
                              "IClientNetwork",
                              "IClientNetworkHost",
                              "IClientApp",
                              "IClientAppHost",
                              "IClientData",
                              "IClientDataHost",
                              "IClientLoggingHost",
                              "IClientReadOnlyNameObjectCollection",
                              "IClientUIHost",
                              "IPAddress",
                              "IPEndPoint",
                              "NanoCore Client",
                              "NanoCore.ClientPlugin",
                              "NanoCore.ClientPluginHost",
                              "get_ClientSettings",
                              "get_Connected"
                          ],
                          "source": "General",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "Windows_Trojan_Nanocore_d8c4e3c5",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "ClientLoaderForm.resources",
                              "AddHostEntry",
                              "GetBlockHash",
                              "IClientAppHost",
                              "IClientLoggingHost",
                              "LogClientException",
                              "NanoCore.ClientPlugin",
                              "NanoCore.ClientPluginHost",
                              "PipeExists",
                              "PluginCommand",
                              "get_BuilderSettings"
                          ],
                          "source": "General",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "Nanocore",
                          "description": "detect Nanocore in memory",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "CommandType",
                              "NanoCore Client",
                              "PluginCommand"
                          ],
                          "source": "Github",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "Nanocore_RAT_Gen_2",
                          "description": "Detetcs the Nanocore RAT",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe",
                              "IClientNetworkHost",
                              "NanoCore.ClientPluginHost"
                          ],
                          "source": "Github",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      },
                      {
                          "name": "NanoCore",
                          "description": "(no description)",
                          "sha256": null,
                          "path": "878535c339d56481_7504_63265001044310442025",
                          "matches": [
                              "#=q",
                              "ClientPlugin",
                              "DESCrypto",
                              "KeepAlive",
                              "LogClientMessage",
                              "NanoCore",
                              "ProjectData",
                              "get_Connected"
                          ],
                          "source": "Github",
                          "sandboxType": [
                              "Win10(1903 64bit,Office2016)"
                          ],
                          "sbType": "Win10(1903 64bit,Office2016)"
                      }
                  ]
              },
              "dropped": {},
              "target": {}
          },
          "sandboxtypes": [
              "Win10(1903 64bit,Office2016)"
          ],
          "merged": {
              "tsmam": [
                  {
                      "name": "MALWARE_Win_NanoCore",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "ClientPlugin",
                          "EndPoint",
                          "IClientNameObjectCollection",
                          "IClientNetwork",
                          "IClientNetworkHost",
                          "IClientApp",
                          "IClientAppHost",
                          "IClientData",
                          "IClientDataHost",
                          "IClientLoggingHost",
                          "IClientReadOnlyNameObjectCollection",
                          "IClientUIHost",
                          "IPAddress",
                          "IPEndPoint",
                          "NanoCore Client",
                          "NanoCore.ClientPlugin",
                          "NanoCore.ClientPluginHost",
                          "get_ClientSettings",
                          "get_Connected"
                      ],
                      "source": "General",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "shellcode",
                      "description": "Matched shellcode byte patterns",
                      "sha256": null,
                      "path": "fd4909a0d0e51318_7504_939301044310442025",
                      "matches": [
                          "558bec81ec",
                          "648b3530"
                      ],
                      "source": "General",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "suspicious_packer_section",
                      "description": "The packer/protector section names/keywords",
                      "sha256": null,
                      "path": "b6455d6e9a931e2c_7504_5969047944310442025",
                      "matches": [
                          "UPX!",
                          "UPX0",
                          "UPX1"
                      ],
                      "source": "Github",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "NanoCore_1",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "#=q",
                          "ClientPlugin",
                          "DESCrypto",
                          "KeepAlive",
                          "LogClientMessage",
                          "NanoCore",
                          "ProjectData",
                          "get_Connected"
                      ],
                      "source": "General",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "Windows_Trojan_Nanocore_d8c4e3c5",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "ClientLoaderForm.resources",
                          "AddHostEntry",
                          "GetBlockHash",
                          "IClientAppHost",
                          "IClientLoggingHost",
                          "LogClientException",
                          "NanoCore.ClientPlugin",
                          "NanoCore.ClientPluginHost",
                          "PipeExists",
                          "PluginCommand",
                          "get_BuilderSettings"
                      ],
                      "source": "General",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "UPX",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "b6455d6e9a931e2c_7504_5969047944310442025",
                      "matches": [
                          "UPX!",
                          "UPX0",
                          "UPX1"
                      ],
                      "source": "Github",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "NanoCore",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "#=q",
                          "ClientPlugin",
                          "DESCrypto",
                          "KeepAlive",
                          "LogClientMessage",
                          "NanoCore",
                          "ProjectData",
                          "get_Connected"
                      ],
                      "source": "Github",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "Nanocore",
                      "description": "detect Nanocore in memory",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "CommandType",
                          "NanoCore Client",
                          "PluginCommand"
                      ],
                      "source": "Github",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "NanoCore",
                      "description": "(no description)",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "ClientPlugin",
                          "LogClientMessage",
                          "NanoCore",
                          "ProjectData"
                      ],
                      "source": "General",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "name": "Nanocore_RAT_Gen_2",
                      "description": "Detetcs the Nanocore RAT",
                      "sha256": null,
                      "path": "878535c339d56481_7504_63265001044310442025",
                      "matches": [
                          "#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe",
                          "IClientNetworkHost",
                          "NanoCore.ClientPluginHost"
                      ],
                      "source": "Github",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbType": "Win10(1903 64bit,Office2016)"
                  }
              ],
              "dropped": [],
              "target": []
          }
      })
  
  // sigma规则
  const sigmaRules = ref({
          "grouped": {
              "Win10(1903 64bit,Office2016)": [
                  {
                      "title": "Scheduled temp file as task from temp location",
                      "description": "Scheduled temp file as task from temp location",
                      "tags": [],
                      "level": "critical",
                      "order": 15,
                      "matches": [
                          {
                              "row_id": 9,
                              "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                              "ProcessGuid": "E0B5ADED-3E8C-67F7-8701-000000002E00",
                              "ProcessId": 6288,
                              "RuleName": "-",
                              "UtcTime": "2025-04-10 03:44:12.256",
                              "EventID": 1,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 1,
                              "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service Task\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp65AB.tmp\"",
                              "Company": "Microsoft Corporation",
                              "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                              "Description": "Task Scheduler Configuration Tool",
                              "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                              "IntegrityLevel": "High",
                              "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                              "LogonId": "0x2da8d",
                              "OriginalFileName": "schtasks.exe",
                              "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                              "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ParentProcessId": 7672,
                              "Product": "Microsoft® Windows® Operating System",
                              "TerminalSessionId": 1
                          },
                          {
                              "row_id": 11,
                              "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                              "ProcessGuid": "E0B5ADED-3E8B-67F7-8101-000000002E00",
                              "ProcessId": 7572,
                              "RuleName": "-",
                              "UtcTime": "2025-04-10 03:44:11.657",
                              "EventID": 1,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 1,
                              "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp6349.tmp\"",
                              "Company": "Microsoft Corporation",
                              "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                              "Description": "Task Scheduler Configuration Tool",
                              "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                              "IntegrityLevel": "High",
                              "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                              "LogonId": "0x2da8d",
                              "OriginalFileName": "schtasks.exe",
                              "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                              "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ParentProcessId": 7672,
                              "Product": "Microsoft® Windows® Operating System",
                              "TerminalSessionId": 1
                          }
                      ],
                      "source": "JoeSecurity",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "title": "Suspicius Add Task From User AppData Temp",
                      "description": "schtasks.exe create task from user AppData\\Local\\Temp",
                      "tags": [
                          "execution",
                          "t1053.005"
                      ],
                      "level": "high",
                      "order": 13,
                      "matches": [
                          {
                              "row_id": 9,
                              "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                              "ProcessGuid": "E0B5ADED-3E8C-67F7-8701-000000002E00",
                              "ProcessId": 6288,
                              "RuleName": "-",
                              "UtcTime": "2025-04-10 03:44:12.256",
                              "EventID": 1,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 1,
                              "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service Task\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp65AB.tmp\"",
                              "Company": "Microsoft Corporation",
                              "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                              "Description": "Task Scheduler Configuration Tool",
                              "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                              "IntegrityLevel": "High",
                              "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                              "LogonId": "0x2da8d",
                              "OriginalFileName": "schtasks.exe",
                              "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                              "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ParentProcessId": 7672,
                              "Product": "Microsoft® Windows® Operating System",
                              "TerminalSessionId": 1
                          },
                          {
                              "row_id": 11,
                              "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                              "ProcessGuid": "E0B5ADED-3E8B-67F7-8101-000000002E00",
                              "ProcessId": 7572,
                              "RuleName": "-",
                              "UtcTime": "2025-04-10 03:44:11.657",
                              "EventID": 1,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 1,
                              "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp6349.tmp\"",
                              "Company": "Microsoft Corporation",
                              "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                              "Description": "Task Scheduler Configuration Tool",
                              "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                              "IntegrityLevel": "High",
                              "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                              "LogonId": "0x2da8d",
                              "OriginalFileName": "schtasks.exe",
                              "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                              "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ParentProcessId": 7672,
                              "Product": "Microsoft® Windows® Operating System",
                              "TerminalSessionId": 1
                          }
                      ],
                      "source": "SigmaHQ",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "title": "Autorun Keys Modification",
                      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
                      "tags": [
                          "persistence",
                          "t1547.001",
                          "t1060"
                      ],
                      "level": "medium",
                      "order": 11,
                      "matches": [
                          {
                              "row_id": 12,
                              "Details": "C:\\Program Files (x86)\\IMAP Service\\imapsvc.exe",
                              "EventType": "SetValue",
                              "Image": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ProcessId": 7672,
                              "RuleName": "T1060,RunKey",
                              "TargetObject": "HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\IMAP Service",
                              "UtcTime": "2025-04-10 03:44:11.506",
                              "EventID": 13,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 13
                          },
                          {
                              "row_id": 17,
                              "Details": "Binary Data",
                              "EventType": "SetValue",
                              "Image": "C:\\Python27\\pythonw.exe",
                              "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                              "ProcessId": 5440,
                              "RuleName": "T1183,IFEO",
                              "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationOptions",
                              "UtcTime": "2025-04-10 03:44:08.640",
                              "EventID": 13,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 13
                          },
                          {
                              "row_id": 18,
                              "Details": "Binary Data",
                              "EventType": "SetValue",
                              "Image": "C:\\Python27\\pythonw.exe",
                              "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                              "ProcessId": 5440,
                              "RuleName": "T1183,IFEO",
                              "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationAuditOptions",
                              "UtcTime": "2025-04-10 03:44:08.640",
                              "EventID": 13,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 13
                          },
                          {
                              "row_id": 19,
                              "Details": "Binary Data",
                              "EventType": "SetValue",
                              "Image": "C:\\Python27\\pythonw.exe",
                              "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                              "ProcessId": 5440,
                              "RuleName": "T1183,IFEO",
                              "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationOptions",
                              "UtcTime": "2025-04-10 03:44:08.640",
                              "EventID": 13,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 13
                          },
                          {
                              "row_id": 20,
                              "Details": "Binary Data",
                              "EventType": "SetValue",
                              "Image": "C:\\Python27\\pythonw.exe",
                              "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                              "ProcessId": 5440,
                              "RuleName": "T1183,IFEO",
                              "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationAuditOptions",
                              "UtcTime": "2025-04-10 03:44:08.640",
                              "EventID": 13,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 13
                          }
                      ],
                      "source": "SigmaHQ",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
                  },
                  {
                      "title": "Possible Applocker Bypass",
                      "description": "Detects execution of executables that can be used to bypass Applocker whitelisting",
                      "tags": [
                          "defense_evasion",
                          "t1118",
                          "t1218.004",
                          "t1121",
                          "t1218.009",
                          "t1127",
                          "t1127.001",
                          "t1170",
                          "t1218.005",
                          "t1218"
                      ],
                      "level": "low",
                      "order": 9,
                      "matches": [
                          {
                              "row_id": 15,
                              "Image": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                              "ProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                              "ProcessId": 7672,
                              "RuleName": "-",
                              "UtcTime": "2025-04-10 03:44:10.022",
                              "EventID": 1,
                              "Keywords": "0x8000000000000000",
                              "Level": 4,
                              "Opcode": 0,
                              "Task": 1,
                              "CommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                              "Company": "Microsoft Corporation",
                              "CurrentDirectory": "C:\\Users\\Administrator\\Desktop\\26c46f\\",
                              "Description": "Microsoft .NET Assembly Registration Utility",
                              "Hashes": "MD5=8B27AF7F70807AB602290FFA63628422,SHA256=424BF38DBCC3C6786E4C82EF3BC64956060B4CDFD54FF581B59ADC7A03E34154,IMPHASH=F34D5F2D4577ED6D9CEEC516C1F5A744",
                              "IntegrityLevel": "High",
                              "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                              "LogonId": "0x2da8d",
                              "OriginalFileName": "RegAsm.exe",
                              "ParentCommandLine": "\"C:\\Users\\Administrator\\Desktop\\26c46f\\dc7ba1.exe\" ",
                              "ParentImage": "C:\\Users\\Administrator\\Desktop\\26c46f\\dc7ba1.exe",
                              "ParentProcessGuid": "E0B5ADED-3E88-67F7-7801-000000002E00",
                              "ParentProcessId": 7504,
                              "Product": "Microsoft® .NET Framework",
                              "TerminalSessionId": 1
                          }
                      ],
                      "source": "SigmaHQ",
                      "sandboxType": [
                          "Win10(1903 64bit,Office2016)"
                      ],
                      "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
                  }
              ]
          },
          "sandboxtypes": [
              "Win10(1903 64bit,Office2016)"
          ],
          "merged": [
              {
                  "title": "Scheduled temp file as task from temp location",
                  "description": "Scheduled temp file as task from temp location",
                  "tags": [],
                  "level": "critical",
                  "order": 15,
                  "matches": [
                      {
                          "row_id": 9,
                          "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                          "ProcessGuid": "E0B5ADED-3E8C-67F7-8701-000000002E00",
                          "ProcessId": 6288,
                          "RuleName": "-",
                          "UtcTime": "2025-04-10 03:44:12.256",
                          "EventID": 1,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 1,
                          "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service Task\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp65AB.tmp\"",
                          "Company": "Microsoft Corporation",
                          "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                          "Description": "Task Scheduler Configuration Tool",
                          "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                          "IntegrityLevel": "High",
                          "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                          "LogonId": "0x2da8d",
                          "OriginalFileName": "schtasks.exe",
                          "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                          "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ParentProcessId": 7672,
                          "Product": "Microsoft® Windows® Operating System",
                          "TerminalSessionId": 1
                      },
                      {
                          "row_id": 11,
                          "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                          "ProcessGuid": "E0B5ADED-3E8B-67F7-8101-000000002E00",
                          "ProcessId": 7572,
                          "RuleName": "-",
                          "UtcTime": "2025-04-10 03:44:11.657",
                          "EventID": 1,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 1,
                          "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp6349.tmp\"",
                          "Company": "Microsoft Corporation",
                          "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                          "Description": "Task Scheduler Configuration Tool",
                          "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                          "IntegrityLevel": "High",
                          "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                          "LogonId": "0x2da8d",
                          "OriginalFileName": "schtasks.exe",
                          "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                          "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ParentProcessId": 7672,
                          "Product": "Microsoft® Windows® Operating System",
                          "TerminalSessionId": 1
                      }
                  ],
                  "source": "JoeSecurity",
                  "sandboxType": [
                      "Win10(1903 64bit,Office2016)"
                  ],
                  "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
              },
              {
                  "title": "Suspicius Add Task From User AppData Temp",
                  "description": "schtasks.exe create task from user AppData\\Local\\Temp",
                  "tags": [
                      "execution",
                      "t1053.005"
                  ],
                  "level": "high",
                  "order": 13,
                  "matches": [
                      {
                          "row_id": 9,
                          "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                          "ProcessGuid": "E0B5ADED-3E8C-67F7-8701-000000002E00",
                          "ProcessId": 6288,
                          "RuleName": "-",
                          "UtcTime": "2025-04-10 03:44:12.256",
                          "EventID": 1,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 1,
                          "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service Task\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp65AB.tmp\"",
                          "Company": "Microsoft Corporation",
                          "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                          "Description": "Task Scheduler Configuration Tool",
                          "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                          "IntegrityLevel": "High",
                          "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                          "LogonId": "0x2da8d",
                          "OriginalFileName": "schtasks.exe",
                          "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                          "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ParentProcessId": 7672,
                          "Product": "Microsoft® Windows® Operating System",
                          "TerminalSessionId": 1
                      },
                      {
                          "row_id": 11,
                          "Image": "C:\\Windows\\SysWOW64\\schtasks.exe",
                          "ProcessGuid": "E0B5ADED-3E8B-67F7-8101-000000002E00",
                          "ProcessId": 7572,
                          "RuleName": "-",
                          "UtcTime": "2025-04-10 03:44:11.657",
                          "EventID": 1,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 1,
                          "CommandLine": "\"schtasks.exe\" /create /f /tn \"IMAP Service\" /xml \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\tmp6349.tmp\"",
                          "Company": "Microsoft Corporation",
                          "CurrentDirectory": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\",
                          "Description": "Task Scheduler Configuration Tool",
                          "Hashes": "MD5=387A4D4FCACD57E5801353159439240E,SHA256=BA97DD9D346C8A478579EDA863504D492FE75B66B9830AF1AACDF1BF2F6513B5,IMPHASH=8F05AFD593956F9A0A28D77A05092AB8",
                          "IntegrityLevel": "High",
                          "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                          "LogonId": "0x2da8d",
                          "OriginalFileName": "schtasks.exe",
                          "ParentCommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                          "ParentImage": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ParentProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ParentProcessId": 7672,
                          "Product": "Microsoft® Windows® Operating System",
                          "TerminalSessionId": 1
                      }
                  ],
                  "source": "SigmaHQ",
                  "sandboxType": [
                      "Win10(1903 64bit,Office2016)"
                  ],
                  "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
              },
              {
                  "title": "Autorun Keys Modification",
                  "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
                  "tags": [
                      "persistence",
                      "t1547.001",
                      "t1060"
                  ],
                  "level": "medium",
                  "order": 11,
                  "matches": [
                      {
                          "row_id": 12,
                          "Details": "C:\\Program Files (x86)\\IMAP Service\\imapsvc.exe",
                          "EventType": "SetValue",
                          "Image": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ProcessId": 7672,
                          "RuleName": "T1060,RunKey",
                          "TargetObject": "HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\IMAP Service",
                          "UtcTime": "2025-04-10 03:44:11.506",
                          "EventID": 13,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 13
                      },
                      {
                          "row_id": 17,
                          "Details": "Binary Data",
                          "EventType": "SetValue",
                          "Image": "C:\\Python27\\pythonw.exe",
                          "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                          "ProcessId": 5440,
                          "RuleName": "T1183,IFEO",
                          "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationOptions",
                          "UtcTime": "2025-04-10 03:44:08.640",
                          "EventID": 13,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 13
                      },
                      {
                          "row_id": 18,
                          "Details": "Binary Data",
                          "EventType": "SetValue",
                          "Image": "C:\\Python27\\pythonw.exe",
                          "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                          "ProcessId": 5440,
                          "RuleName": "T1183,IFEO",
                          "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationAuditOptions",
                          "UtcTime": "2025-04-10 03:44:08.640",
                          "EventID": 13,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 13
                      },
                      {
                          "row_id": 19,
                          "Details": "Binary Data",
                          "EventType": "SetValue",
                          "Image": "C:\\Python27\\pythonw.exe",
                          "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                          "ProcessId": 5440,
                          "RuleName": "T1183,IFEO",
                          "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationOptions",
                          "UtcTime": "2025-04-10 03:44:08.640",
                          "EventID": 13,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 13
                      },
                      {
                          "row_id": 20,
                          "Details": "Binary Data",
                          "EventType": "SetValue",
                          "Image": "C:\\Python27\\pythonw.exe",
                          "ProcessGuid": "E0B5ADED-3E71-67F7-9F00-000000002E00",
                          "ProcessId": 5440,
                          "RuleName": "T1183,IFEO",
                          "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\dc7ba1.exe\\MitigationAuditOptions",
                          "UtcTime": "2025-04-10 03:44:08.640",
                          "EventID": 13,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 13
                      }
                  ],
                  "source": "SigmaHQ",
                  "sandboxType": [
                      "Win10(1903 64bit,Office2016)"
                  ],
                  "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
              },
              {
                  "title": "Possible Applocker Bypass",
                  "description": "Detects execution of executables that can be used to bypass Applocker whitelisting",
                  "tags": [
                      "defense_evasion",
                      "t1118",
                      "t1218.004",
                      "t1121",
                      "t1218.009",
                      "t1127",
                      "t1127.001",
                      "t1170",
                      "t1218.005",
                      "t1218"
                  ],
                  "level": "low",
                  "order": 9,
                  "matches": [
                      {
                          "row_id": 15,
                          "Image": "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe",
                          "ProcessGuid": "E0B5ADED-3E8A-67F7-7B01-000000002E00",
                          "ProcessId": 7672,
                          "RuleName": "-",
                          "UtcTime": "2025-04-10 03:44:10.022",
                          "EventID": 1,
                          "Keywords": "0x8000000000000000",
                          "Level": 4,
                          "Opcode": 0,
                          "Task": 1,
                          "CommandLine": "\"C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\RegAsm.exe\"",
                          "Company": "Microsoft Corporation",
                          "CurrentDirectory": "C:\\Users\\Administrator\\Desktop\\26c46f\\",
                          "Description": "Microsoft .NET Assembly Registration Utility",
                          "Hashes": "MD5=8B27AF7F70807AB602290FFA63628422,SHA256=424BF38DBCC3C6786E4C82EF3BC64956060B4CDFD54FF581B59ADC7A03E34154,IMPHASH=F34D5F2D4577ED6D9CEEC516C1F5A744",
                          "IntegrityLevel": "High",
                          "LogonGuid": "E0B5ADED-C936-656F-8DDA-020000000000",
                          "LogonId": "0x2da8d",
                          "OriginalFileName": "RegAsm.exe",
                          "ParentCommandLine": "\"C:\\Users\\Administrator\\Desktop\\26c46f\\dc7ba1.exe\" ",
                          "ParentImage": "C:\\Users\\Administrator\\Desktop\\26c46f\\dc7ba1.exe",
                          "ParentProcessGuid": "E0B5ADED-3E88-67F7-7801-000000002E00",
                          "ParentProcessId": 7504,
                          "Product": "Microsoft® .NET Framework",
                          "TerminalSessionId": 1
                      }
                  ],
                  "source": "SigmaHQ",
                  "sandboxType": [
                      "Win10(1903 64bit,Office2016)"
                  ],
                  "sbTypeForGroup": "Win10(1903 64bit,Office2016)"
              }
          ]
      })
  
  // 静态分析数据
  const staticData = ref({
          "baseInfo": {
              "文件名称": "004ad8ce84b9ab95d4c38a9d7b23dce68d134c696c1362625ad38153b48038e5",
              "文件格式": "EXEx86",
              "文件Magic": "PE32 executable (console) Intel 80386, for MS Windows",
              "文件大小": "14.55KB",
              "SHA256": "004ad8ce84b9ab95d4c38a9d7b23dce68d134c696c1362625ad38153b48038e5",
              "SHA1": "6cf5dc082af22c2863f3b925aaa06bb3e0513c46",
              "MD5": "5b63ebdc906a189ee6dae807246506e5",
              "CRC32": "E3ACAD6A",
              "SSDEEP": "384:hdtXWiJCQxsEwvK3RpSSHuGQG2Rqm4YhYEL:hDXWipuE+K3/SSHgxmE",
              "TLSH": "T19B627C2AE9499036C3E804F813B6C367BA7F51A1534523E7BB735DDC8D48490EC63A6D",
              "AuthentiHash": "69D14FD09682A3755FA87602F209D560DE2B6707C39D0E8328695FABE6C46A01",
              "peHashNG": "5f9a88f0f6969e294313fd8413845b0eef6379c5e2a9ed05a740741bc779f05f",
              "RichHash": "410c803093d4c1afcacac1e0055b360f",
              "impfuzzy": "24:kd1BzeLKTUdQr+FzJTGPJ/3M/Tl5F6O58yldfDKb:c1leLtdkiKM/wO5ZldfDKb",
              "ImpHash": "432c342c05744facf1143abcda5d68c4",
              "Tags": "exe,pdb_path,lang_english"
          },
          "findCrypt": [],
          "pe": {
              "pdbMap": {
                  "PDB": "C:\\ping_pong\\win_client\\Release\\win_client.pdb",
                  "GUID": null
              },
              "resourcesMap": [
                  {
                      "name": "RT_MANIFEST",
                      "filetype": "ASCII text, with CRLF line terminators",
                      "size": "0x0000015a",
                      "offset": "0x00004058",
                      "language": "LANG_ENGLISH",
                      "sublanguage": "SUBLANG_ENGLISH_US"
                  }
              ],
              "importsMap": [
                  {
                      "dll": "KERNEL32.dll",
                      "imports": [
                          {
                              "address": "0x402000",
                              "name": "Sleep"
                          },
                          {
                              "address": "0x402004",
                              "name": "CreateProcessA"
                          },
                          {
                              "address": "0x402008",
                              "name": "GetTempFileNameA"
                          },
                          {
                              "address": "0x40200c",
                              "name": "GetModuleFileNameA"
                          },
                          {
                              "address": "0x402010",
                              "name": "CloseHandle"
                          },
                          {
                              "address": "0x402014",
                              "name": "GetTempPathA"
                          },
                          {
                              "address": "0x402018",
                              "name": "GetSystemTimeAsFileTime"
                          },
                          {
                              "address": "0x40201c",
                              "name": "GetCurrentProcessId"
                          },
                          {
                              "address": "0x402020",
                              "name": "GetCurrentThreadId"
                          },
                          {
                              "address": "0x402024",
                              "name": "GetTickCount"
                          },
                          {
                              "address": "0x402028",
                              "name": "QueryPerformanceCounter"
                          },
                          {
                              "address": "0x40202c",
                              "name": "DecodePointer"
                          },
                          {
                              "address": "0x402030",
                              "name": "IsDebuggerPresent"
                          },
                          {
                              "address": "0x402034",
                              "name": "SetUnhandledExceptionFilter"
                          },
                          {
                              "address": "0x402038",
                              "name": "UnhandledExceptionFilter"
                          },
                          {
                              "address": "0x40203c",
                              "name": "GetCurrentProcess"
                          },
                          {
                              "address": "0x402040",
                              "name": "TerminateProcess"
                          },
                          {
                              "address": "0x402044",
                              "name": "EncodePointer"
                          },
                          {
                              "address": "0x402048",
                              "name": "InterlockedCompareExchange"
                          },
                          {
                              "address": "0x40204c",
                              "name": "InterlockedExchange"
                          },
                          {
                              "address": "0x402050",
                              "name": "HeapSetInformation"
                          }
                      ],
                      "count": 21
                  },
                  {
                      "dll": "SHELL32.dll",
                      "imports": [
                          {
                              "address": "0x4020f0",
                              "name": "ShellExecuteA"
                          }
                      ],
                      "count": 1
                  },
                  {
                      "dll": "WS2_32.dll",
                      "imports": [
                          {
                              "address": "0x4020f8",
                              "name": "inet_addr"
                          },
                          {
                              "address": "0x4020fc",
                              "name": "WSAGetLastError"
                          },
                          {
                              "address": "0x402100",
                              "name": "htons"
                          },
                          {
                              "address": "0x402104",
                              "name": "WSAStartup"
                          },
                          {
                              "address": "0x402108",
                              "name": "recv"
                          },
                          {
                              "address": "0x40210c",
                              "name": "socket"
                          },
                          {
                              "address": "0x402110",
                              "name": "send"
                          },
                          {
                              "address": "0x402114",
                              "name": "connect"
                          },
                          {
                              "address": "0x402118",
                              "name": "WSACleanup"
                          }
                      ],
                      "count": 9
                  },
                  {
                      "dll": "MSVCR100.dll",
                      "imports": [
                          {
                              "address": "0x402058",
                              "name": "printf"
                          },
                          {
                              "address": "0x40205c",
                              "name": "fopen"
                          },
                          {
                              "address": "0x402060",
                              "name": "fread"
                          },
                          {
                              "address": "0x402064",
                              "name": "rand"
                          },
                          {
                              "address": "0x402068",
                              "name": "srand"
                          },
                          {
                              "address": "0x40206c",
                              "name": "fwrite"
                          },
                          {
                              "address": "0x402070",
                              "name": "ftell"
                          },
                          {
                              "address": "0x402074",
                              "name": "fseek"
                          },
                          {
                              "address": "0x402078",
                              "name": "fclose"
                          },
                          {
                              "address": "0x40207c",
                              "name": "_time64"
                          },
                          {
                              "address": "0x402080",
                              "name": "_snprintf"
                          },
                          {
                              "address": "0x402084",
                              "name": "_amsg_exit"
                          },
                          {
                              "address": "0x402088",
                              "name": "__getmainargs"
                          },
                          {
                              "address": "0x40208c",
                              "name": "_cexit"
                          },
                          {
                              "address": "0x402090",
                              "name": "_exit"
                          },
                          {
                              "address": "0x402094",
                              "name": "_XcptFilter"
                          },
                          {
                              "address": "0x402098",
                              "name": "exit"
                          },
                          {
                              "address": "0x40209c",
                              "name": "__initenv"
                          },
                          {
                              "address": "0x4020a0",
                              "name": "_initterm"
                          },
                          {
                              "address": "0x4020a4",
                              "name": "_initterm_e"
                          },
                          {
                              "address": "0x4020a8",
                              "name": "_configthreadlocale"
                          },
                          {
                              "address": "0x4020ac",
                              "name": "__setusermatherr"
                          },
                          {
                              "address": "0x4020b0",
                              "name": "_commode"
                          },
                          {
                              "address": "0x4020b4",
                              "name": "_fmode"
                          },
                          {
                              "address": "0x4020b8",
                              "name": "__set_app_type"
                          },
                          {
                              "address": "0x4020bc",
                              "name": "_crt_debugger_hook"
                          },
                          {
                              "address": "0x4020c0",
                              "name": "?terminate@@YAXXZ"
                          },
                          {
                              "address": "0x4020c4",
                              "name": "_unlock"
                          },
                          {
                              "address": "0x4020c8",
                              "name": "__dllonexit"
                          },
                          {
                              "address": "0x4020cc",
                              "name": "_lock"
                          },
                          {
                              "address": "0x4020d0",
                              "name": "_onexit"
                          },
                          {
                              "address": "0x4020d4",
                              "name": "_except_handler4_common"
                          },
                          {
                              "address": "0x4020d8",
                              "name": "_invoke_watson"
                          },
                          {
                              "address": "0x4020dc",
                              "name": "_controlfp_s"
                          },
                          {
                              "address": "0x4020e0",
                              "name": "atoi"
                          },
                          {
                              "address": "0x4020e4",
                              "name": "malloc"
                          },
                          {
                              "address": "0x4020e8",
                              "name": "memset"
                          }
                      ],
                      "count": 37
                  }
              ],
              "signcheckMap": [
                  {
                      "value": [
                          {
                              "name": "Unsigned"
                          }
                      ],
                      "key": "签名验证"
                  }
              ],
              "exportsMap": [],
              "tlsInfoMap": {},
              "fileMap": {
                  "urls": [],
                  "strings": {
                      "Unicode": [
                          "cmd.exe /C ping -w 50 -n 1 1.1.1.1 > Nul & Del "
                      ],
                      "ASCII": [
                          "__getmainargs",
                          "GetTempPathA",
                          "echo_and_return: Sending echo token...",
                          "RSDS`b",
                          "10.180.0.115",
                          "_amsg_exit",
                          "echo_and_return: The test string sent: \"%s\"",
                          "%s:%d DATA CORRUPT.",
                          "C:\\ping_pong\\win_client\\Release\\win_client.pdb",
                          "_initterm",
                          "get_port_from_controller: connect() is OK.",
                          "get_port_from_controller:: Received data is: \"%s\"",
                          "%s \"%s\"",
                          "CloseHandle",
                          "EncodePointer",
                          "file_size is: %d",
                          "GetCurrentThreadId",
                          "%s: option requires an argument -- %.*s",
                          "ADAMANDPRASHANTAREAWESOME",
                          "malloc",
                          "WS2_32.dll",
                          "echo_and_return: send() error %ld.",
                          "_time64",
                          "_onexit",
                          "%s: option does not take an argument -- %.*s",
                          "GetTempFileNameA",
                          "InterlockedCompareExchange",
                          "Got controller port: %d",
                          "get_port_from_controller: connect() - Failed to connect and get port.",
                          "_except_handler4_common",
                          "[!]Failed to get echo port from server.",
                          "%s:%d DATA OK.",
                          "CreateProcessA",
                          "_crt_debugger_hook",
                          "Attempting to execute: %s",
                          "__initenv",
                          "echo_and_return: send() is OK - Bytes sent: %ld",
                          "Client: WSAStartup() is OK.",
                          "__dllonexit",
                          "_snprintf",
                          "SetUnhandledExceptionFilter",
                          "ShellExecuteA",
                          "get_port_from_controller: Connection Closed.",
                          "_unlock",
                          "echo_and_return: connect() - Failed to connect to server(%s) port:%d",
                          "GetSystemTimeAsFileTime",
                          "Client: Error at WSAStartup().",
                          "TerminateProcess",
                          "_fmode",
                          "get_port_from_controller:: Bytes received is: %ld.",
                          "UnhandledExceptionFilter",
                          "echo_and_return: socket() is OK.",
                          "memset",
                          "Got my filename: %s",
                          "QueryPerformanceCounter",
                          "_invoke_watson",
                          "IsDebuggerPresent",
                          "DecodePointer",
                          "Wrote %d bytes to %s",
                          "fwrite",
                          "GetTickCount",
                          "?terminate@@YAXXZ",
                          "_XcptFilter",
                          "GetModuleFileNameA",
                          "get_port_from_controller:: Received data is: \"%d\"",
                          "Unable to open: %s",
                          "get_port_from_controller: Getting echo port...",
                          "__setusermatherr",
                          "_controlfp_s",
                          "_configthreadlocale",
                          "__set_app_type",
                          "get_port_from_controller: socket() is OK.",
                          "HeapSetInformation",
                          "_initterm_e",
                          "echo_and_return: socket() - Error at socket(): %ld",
                          "SHELL32.dll",
                          "echo_and_return: connect() is OK.",
                          "get_port_from_controller:: recv() is OK.",
                          "printf",
                          "_cexit",
                          "_commode",
                          "InterlockedExchange",
                          "get_port_from_controller: socket() - Error at socket(): %ld",
                          "KERNEL32.dll",
                          "GetCurrentProcessId",
                          "MSVCR100.dll",
                          "fclose",
                          "GetCurrentProcess",
                          "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">",
                          "</assembly>PA",
                          "  </trustInfo>",
                          "    <security>",
                          "      <requestedPrivileges>",
                          "    </security>",
                          "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel>",
                          "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">",
                          "      </requestedPrivileges>",
                          "3)4/4<4J4Q4g4",
                          "6$606C6L6S6q6|6",
                          "8(8;8E8J8O8q8v8",
                          ":\":(:.:4:::@:G:N:U:\\:c:j:q:y:",
                          ";_;e;n;u;",
                          "=/=M=a=g=",
                          "9%9.949<9H9Z9e9k9}9",
                          "?&?,?2?8?>?D?J?P?V?",
                          ";.<3<T<Y<x<",
                          "14191D1L1i1",
                          "2&252:2E2\\2c2q2x2",
                          "0=0d0j0p0y0",
                          "525T5b5n5",
                          "7!7L7q7",
                          "$10141\\1`1",
                          "2*3E3L3v3"
                      ]
                  }
              },
              "headMap": {
                  "平台": "Intel 386 or later processors and compatible processors",
                  "子系统": "Windows character-mode user interface (CUI) subsystem",
                  "编译时间戳": "2012-08-11 00:14:27",
                  "入口点(OEP)": "0x1a0c",
                  "入口所在段": ".text",
                  "镜像基地址": "0x400000",
                  "节区数量": 5,
                  "LinkerVersion": 10
              },
              "sectionsMap": [
                  {
                      "name": ".text",
                      "virtual_address": "0x00001000",
                      "virtual_size": "0x00000f5a",
                      "pointer_to_rawdata": "0x00000400",
                      "size_of_data": "0x00001000",
                      "SectionPermission": "R-E",
                      "entropy": 6.004661832472822,
                      "hash": "11e71d6b64d3f84fd96375bec2a90941"
                  },
                  {
                      "name": ".rdata",
                      "virtual_address": "0x00002000",
                      "virtual_size": "0x00000d6c",
                      "pointer_to_rawdata": "0x00001400",
                      "size_of_data": "0x00000e00",
                      "SectionPermission": "R--",
                      "entropy": 5.086139462894463,
                      "hash": "4e808bd6fbb49b84e2b248c5c9c480a1"
                  },
                  {
                      "name": ".data",
                      "virtual_address": "0x00003000",
                      "virtual_size": "0x00000394",
                      "pointer_to_rawdata": "0x00002200",
                      "size_of_data": "0x00000200",
                      "SectionPermission": "RW-",
                      "entropy": 0.3840168641038749,
                      "hash": "09d5436bea5eda2762b499561f060d95"
                  },
                  {
                      "name": ".rsrc",
                      "virtual_address": "0x00004000",
                      "virtual_size": "0x000001b4",
                      "pointer_to_rawdata": "0x00002400",
                      "size_of_data": "0x00000200",
                      "SectionPermission": "R--",
                      "entropy": 5.097979088823027,
                      "hash": "04e3534c39fb38c8dc21bcd423a64b95"
                  },
                  {
                      "name": ".reloc",
                      "virtual_address": "0x00005000",
                      "virtual_size": "0x000002ae",
                      "pointer_to_rawdata": "0x00002600",
                      "size_of_data": "0x00000400",
                      "SectionPermission": "R--",
                      "entropy": 4.217332307966828,
                      "hash": "5dd96ab397b2c6a3cf2decf25f08d928"
                  }
              ]
          },
          "magika": {},
          "exifTool": {
              "FileType": "Win32 EXE",
              "FileTypeExtension": "exe",
              "MIMEType": "application/octet-stream",
              "MachineType": "Intel 386 or later, and compatibles",
              "TimeStamp": "2012:08:11 00:14:27+08:00",
              "ImageFileCharacteristics": "Executable, 32-bit",
              "PEType": "PE32",
              "LinkerVersion": "10.0",
              "CodeSize": 4096,
              "InitializedDataSize": 5632,
              "UninitializedDataSize": 0,
              "EntryPoint": "0x1a0c",
              "OSVersion": "5.1",
              "ImageVersion": "0.0",
              "SubsystemVersion": "5.1",
              "Subsystem": "Windows command line"
          },
          "diec": {
              "链接器": "Microsoft Linker(10.00.30319)",
              "编译器": "Microsoft Visual C/C++(16.00.30319)[LTCG/C++]",
              "工具": "Visual Studio(2010)",
              "字节序": "LE",
              "模式": "32",
              "程序类型": "Console",
              "文件类型": "PE32",
              "熵": 6.539594101865142,
              "语言": "C/C++",
              "操作系统": "Windows(XP)[I386, 32位, Console]"
          },
          "trid": {
              "32.2% (.EXE)": "Microsoft Visual C++ compiled executable (generic) (16529/12/5)",
              "20.5% (.EXE)": "Win64 Executable (generic) (10523/12/4)",
              "12.8% (.DLL)": "Win32 Dynamic Link Library (generic) (6578/25/2)",
              "9.8% (.EXE)": "Win16 NE executable (generic) (5038/12/1)",
              "8.7% (.EXE)": "Win32 Executable (generic) (4505/5/1)"
          }
      })
  // 动态分析数据
  
  // 引擎检测数据
  const engineData = ref({
    total: 28,
    recent_scan: "2025-04-08 13:12:44",
    report_num: 12,
    engine_result: [
      {
        result: "Trojan:Win32/Vindor!pz",
        engine: "Microsoft",
        engine_desc: "微软（MSE）"
      },
      {
        result: "a variant of Win32/Agent.ADRA trojan",
        engine: "ESET",
        engine_desc: "ESET"
      },
      {
        result: "Trojan.PiPong",
        engine: "IKARUS",
        engine_desc: "IKARUS"
      },
      {
        result: "Trojan.Siggen15.32258",
        engine: "Dr.Web",
        engine_desc: "大蜘蛛（Dr.Web）"
      },
      {
        result: "Win32:TrojanX-gen",
        engine: "Avast",
        engine_desc: "Avast"
      },
      {
        result: "Win32:TrojanX-gen",
        engine: "AVG",
        engine_desc: "AVG"
      },
      {
        result: "Generic.Dacic.310FD38C.A.1B9B4BCC",
        engine: "GDATA",
        engine_desc: "GDATA"
      },
      {
        result: "Trojan ( 0058a19d1 )",
        engine: "K7",
        engine_desc: "K7"
      },
      {
        result: "Trojan/Win32.Vindor",
        engine: "Antiy",
        engine_desc: "安天（Antiy）"
      },
      {
        result: "Trojan.Agent.douz",
        engine: "JiangMin",
        engine_desc: "江民（JiangMin）"
      },
      {
        result: "Trojan.Win32.TrjGen.jidpck",
        engine: "NANO",
        engine_desc: "NANO"
      },
      {
        result: "Trj/Genetic.gen",
        engine: "Panda",
        engine_desc: "熊猫（Panda）"
      },
      {
        result: "safe",
        engine: "Kaspersky",
        engine_desc: "卡巴斯基（Kaspersky）"
      },
      {
        result: "safe",
        engine: "Avira",
        engine_desc: "小红伞（Avira）"
      },
      {
        result: "safe",
        engine: "Qihu360",
        engine_desc: "360（Qihoo 360）"
      },
      {
        result: "safe",
        engine: "Baidu",
        engine_desc: "Baidu"
      },
      {
        result: "safe",
        engine: "Trustlook",
        engine_desc: "Trustlook"
      },
      {
        result: "safe",
        engine: "Rising",
        engine_desc: "瑞星（Rising）"
      },
      {
        result: "safe",
        engine: "Sophos",
        engine_desc: "Sophos"
      },
      {
        result: "safe",
        engine: "ClamAV",
        engine_desc: "ClamAV"
      },
      {
        result: "safe",
        engine: "vbwebshell",
        engine_desc: "WebShell专杀"
      },
      {
        result: "safe",
        engine: "Baidu-China",
        engine_desc: "Baidu-China"
      },
      {
        result: "safe",
        engine: "MicroAPT",
        engine_desc: "MicroAPT"
      },
      {
        result: "safe",
        engine: "OneAV",
        engine_desc: "OneAV"
      },
      {
        result: "safe",
        engine: "OneStatic",
        engine_desc: "OneStatic"
      },
      {
        result: "safe",
        engine: "NonePe",
        engine_desc: "MicroNonPE"
      },
      {
        result: "safe",
        engine: "PwSH",
        engine_desc: "OneAV-PWSH"
      },
      {
        result: "safe",
        engine: "ShellPub",
        engine_desc: "ShellPub"
      }
    ]
  })
  
  const showAllEngines = ref(false)
  
  const displayEngines = computed(() => {
    return showAllEngines.value 
      ? engineData.value.engine_result 
      : engineData.value.engine_result.slice(0, 4)
  })
  
  // 静态分析相关状态
  const expandedDlls = ref([])
  
  const toggleDllDetails = (dllName) => {
    const index = expandedDlls.value.indexOf(dllName)
    if (index === -1) {
      expandedDlls.value.push(dllName)
    } else {
      expandedDlls.value.splice(index, 1)
    }
  }
  
  const activeStringTab = ref('ASCII')
  
  const showDerivativeDropdown = ref(false)
  const showReportDropdown = ref(false)
  const showDownloadHover = ref(false)
  const showAnalyzeHover = ref(false)
  
  const expandedMatches = ref([])
  
  const toggleMatches = (title) => {
    const index = expandedMatches.value.indexOf(title)
    if (index === -1) {
      expandedMatches.value.push(title)
    } else {
      expandedMatches.value.splice(index, 1)
    }
  }
  
  const expandedYaraMatches = ref([])
  
  const toggleYaraMatches = (name) => {
    const index = expandedYaraMatches.value.indexOf(name)
    if (index === -1) {
      expandedYaraMatches.value.push(name)
    } else {
      expandedYaraMatches.value.splice(index, 1)
    }
  }
  
  // 行为检测相关
  const expandedBehaviors = ref([])
  
  const toggleBehavior = (name) => {
    const index = expandedBehaviors.value.indexOf(name)
    if (index === -1) {
      expandedBehaviors.value.push(name)
    } else {
      expandedBehaviors.value.splice(index, 1)
    }
  }
  
  // 按危险等级分类行为
  const maliciousBehaviors = computed(() => {
    return behaviorDetection.value.filter(b => b.severityStr === 'malicious')
  })
  
  const suspiciousBehaviors = computed(() => {
    return behaviorDetection.value.filter(b => b.severityStr === 'suspicious')
  })
  
  const generalBehaviors = computed(() => {
    return behaviorDetection.value.filter(b => b.severityStr === 'general')
  })
  
  // 加载样本详情
  const loadSampleDetail = async () => {
    try {
      const response = await getSample(sha256)
      // 更新组件中的数据
      fileInfo.value = {
        fileName: response.file_name,
        firstSubmit: response.first_submit_time,
        lastSubmit: response.last_submit_time,
        lastAnalysis: response.last_analysis_time,
        fileSize: response.file_size,
        fileType: response.file_type,
        detectionRatio: `${response.detection_count} / ${response.total_engines}`,
        environment: response.environment,
        threatType: response.threat_type,
        malwareFamily: response.malware_family,
        sha256: response.sha256_digest,
        md5: response.md5,
        sha1: response.sha1
      }
      // 更新其他数据...
    } catch (error) {
      console.error('Failed to load sample detail:', error)
      ElMessage.error('加载样本详情失败')
    }
  }
  
  onMounted(() => {
    loadSampleDetail()
  })
  </script>
  
  <style scoped>
  .sandbox-container {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    color: #333;
    background-color: #f5f5f5;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  /* 顶部导航栏样式 */
  .header {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1.5rem;
    background-color: white;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }
  
  .header-left {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }
  
  .logo {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background-color: #e53935;
    border-radius: 4px;
  }
  
  .logo-text {
    font-size: 1.25rem;
    font-weight: bold;
    color: white;
  }
  
  .search-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .search-box {
    display: flex;
    align-items: center;
    background-color: #f5f5f5;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    width: 400px;
  }
  
  .search-box input {
    border: none;
    background: transparent;
    width: 100%;
    margin-left: 0.5rem;
    outline: none;
  }
  
  .advanced-search {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    background: none;
    border: none;
    cursor: pointer;
    color: #666;
  }
  
  .header-right {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  .nav-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem 0.75rem;
    font-size: 0.9rem;
    color: #333;
  }
  
  .nav-btn.highlight {
    background-color: #e53935;
    color: white;
    border-radius: 4px;
  }
  
  /* 主要内容区域样式 */
  .main-content {
    flex: 1;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  
  .file-info-container {
    display: flex;
    background-color: white;
    border-radius: 8px;
    padding: 2rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    width: 100%;
  }
  
  .file-icon-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-right: 2rem;
  }
  
  .file-icon {
    width: 120px;
    height: 120px;
    background-color: #fff8f8;
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 0.5rem;
  }
  
  .malware-icon {
    color: #e53935;
  }
  
  .malware-label {
    color: #e53935;
    font-weight: bold;
  }
  
  .file-details {
    flex: 1;
  }
  
  .file-name {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    word-break: break-all;
  }
  
  .file-metadata {
    margin-bottom: 1.5rem;
  }
  
  .metadata-row {
    display: flex;
    margin-bottom: 1rem;
  }
  
  .metadata-item {
    display: flex;
    margin-right: 2rem;
    min-width: 250px;
  }
  
  .metadata-label {
    color: #666;
    width: 80px;
  }
  
  .metadata-value {
    font-weight: 500;
  }
  
  .detection-ratio {
    color: #e53935;
  }
  
  .environment-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background-color: #e3f2fd;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .threat-tag {
    display: inline-flex;
    align-items: center;
    background-color: #ffebee;
    color: #e53935;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
    margin-right: 0.5rem;
  }
  
  .family-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background-color: #fff8e1;
    color: #ff8f00;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .help-icon {
    color: #999;
    cursor: pointer;
    margin-left: 0.25rem;
  }
  
  .hash-section {
    margin-bottom: 1.5rem;
  }
  
  .hash-section h3 {
    font-size: 1rem;
    margin-bottom: 0.5rem;
    color: #666;
  }
  
  .hash-row {
    display: flex;
    margin-bottom: 0.5rem;
  }
  
  .hash-label {
    width: 80px;
    color: #666;
  }
  
  .hash-value {
    font-family: monospace;
    word-break: break-all;
  }
  
  .action-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .action-btn {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    background-color: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 0.5rem 0.75rem;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
  }
  
  .action-btn.hover {
    background-color: #e53935;
    border-color: #e53935;
    color: white;
  }
  
  .action-btn.hover svg {
    color: white;
  }
  
  .action-btn.dropdown {
    padding-right: 0.5rem;
  }
  
  /* 分析结果标签页样式 */
  .analysis-tabs {
    display: flex;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    flex: 1;
    min-height: 600px;
  }
  
  .sidebar {
    min-width: 200px;
    background-color: #f9f9f9;
    border-right: 1px solid #eee;
    padding: 1rem 0;
    flex-shrink: 0;
  }
  
  .sidebar-item, .environment-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    cursor: pointer;
    color: #666;
  }
  
  .sidebar-item:hover, .environment-item:hover {
    background-color: #f0f0f0;
  }
  
  .sidebar-item.active {
    background-color: #e3f2fd;
    color: #1976d2;
    border-left: 3px solid #1976d2;
  }
  
  .environment-item {
    margin-top: 1rem;
    border-top: 1px solid #eee;
    padding-top: 1rem;
  }
  
  .tab-content {
    flex: 1;
    padding: 1.5rem;
    overflow: auto;
  }
  
  .section-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }
  
  .section-header h3 {
    font-size: 1.1rem;
    font-weight: 500;
  }
  
  .ioc-table {
    width: 100%;
    overflow-x: auto;
  }
  
  .ioc-table table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .ioc-table th {
    text-align: left;
    padding: 0.75rem;
    background-color: #f5f5f5;
    border-bottom: 1px solid #eee;
    font-weight: 500;
  }
  
  .ioc-table td {
    padding: 0.75rem;
    border-bottom: 1px solid #eee;
  }
  
  .danger-text {
    color: #e53935;
    font-weight: 500;
  }
  
  .danger-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background-color: #ffebee;
    color: #e53935;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
    margin-right: 0.25rem;
    margin-bottom: 0.25rem;
  }
  
  .mitre-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f5f5f5;
    padding: 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
  }
  
  .view-details-btn {
    color: #1976d2;
    background: none;
    border: none;
    cursor: pointer;
    text-decoration: underline;
  }
  
  .high-risk-section {
    background-color: #fff8f8;
    border-radius: 4px;
    padding: 1rem;
  }
  
  .risk-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }
  
  .danger-icon {
    color: #e53935;
  }
  
  .risk-header h4 {
    color: #e53935;
    font-weight: 500;
    margin: 0;
  }
  
  .risk-content {
    padding-left: 1.5rem;
  }
  
  .risk-item {
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px dashed #ffcdd2;
  }
  
  .risk-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }
  
  .risk-title {
    font-weight: 500;
    margin-bottom: 0.5rem;
  }
  
  .risk-description {
    color: #666;
    font-size: 0.9rem;
  }
  
  .placeholder-content {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 300px;
    background-color: #f9f9f9;
    border-radius: 4px;
  }
  
  .placeholder-message {
    color: #999;
    font-size: 1.1rem;
  }
  
  .icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* 响应式调整 */
  @media (max-width: 1440px) {
    .main-content {
      padding: 1rem;
    }
  }
  
  @media (max-width: 1024px) {
    .metadata-row {
      flex-direction: column;
    }
    
    .metadata-item {
      margin-bottom: 0.5rem;
    }
    
    .file-info-container {
      flex-direction: column;
    }
    
    .file-icon-container {
      margin-right: 0;
      margin-bottom: 1.5rem;
    }
    
    .analysis-tabs {
      flex-direction: column;
    }
    
    .sidebar {
      width: 100%;
      display: flex;
      overflow-x: auto;
      padding: 0.5rem;
    }
    
    .sidebar-item, .environment-item {
      padding: 0.5rem 0.75rem;
      white-space: nowrap;
    }
    
    .sidebar-item.active {
      border-left: none;
      border-bottom: 3px solid #1976d2;
    }
    
    .environment-item {
      margin-top: 0;
      border-top: none;
      padding-top: 0.5rem;
    }
  }
  
  @media (max-width: 768px) {
    .header {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
    
    .header-left {
      width: 100%;
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
    
    .search-container {
      width: 100%;
    }
    
    .search-box {
      width: 100%;
    }
    
    .header-right {
      width: 100%;
      justify-content: space-between;
    }
    
    .action-buttons {
      justify-content: center;
    }
  }
  
  .engine-detection {
    padding: 1rem;
  }
  
  .detection-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
  }
  
  .detection-header h3 {
    font-size: 1.1rem;
    font-weight: 500;
  }
  
  .detection-summary {
    display: flex;
    gap: 1.5rem;
    color: #666;
  }
  
  .detection-ratio {
    color: #e53935;
    font-weight: 500;
  }
  
  .engine-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1rem;
  }
  
  .engine-item {
    padding: 1rem;
    background-color: #f9f9f9;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .engine-name {
    font-weight: 500;
    color: #333;
  }
  
  .engine-result {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.9rem;
    color: #666;
  }
  
  .engine-result.is-malicious {
    color: #e53935;
  }
  
  .alert-icon {
    color: #e53935;
  }
  
  .show-more {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
    padding: 0.5rem;
    cursor: pointer;
    color: #1976d2;
  }
  
  .show-more:hover {
    background-color: #f5f5f5;
    border-radius: 4px;
  }
  
  .rotate-180 {
    transform: rotate(180deg);
    transition: transform 0.3s ease;
  }
  
  /* 静态分析样式 */
  .static-analysis {
    padding: 1rem;
  }
  
  .analysis-section {
    background: white;
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
  }
  
  .section-title {
    font-size: 1.1rem;
    font-weight: 500;
    margin-bottom: 1rem;
    color: #333;
  }
  
  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    padding: 0.5rem 0;
  }
  
  .info-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.5rem;
    background: #f9f9f9;
    padding: 0.75rem;
    border-radius: 4px;
    font-size: 0.9rem;
  }
  
  .info-item {
    position: relative;
    padding: 0.5rem 0.75rem;
    background: white;
    border-radius: 4px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
  }
  
  .info-label {
    color: #666;
    white-space: nowrap;
    font-weight: 500;
    min-width: 120px;
    padding-right: 1rem;
  }
  
  .info-value {
    color: #333;
    word-break: break-all;
    flex: 1;
    font-family: monospace;
    font-size: 0.85rem;
  }
  
  .info-divider {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(to right, #e3f2fd, transparent);
  }
  
  .sections-table-container {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid #eee;
    border-radius: 4px;
  }
  
  .sections-table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .sections-table th,
  .sections-table td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid #eee;
  }
  
  .sections-table th {
    background: #f5f5f5;
    font-weight: 500;
    position: sticky;
    top: 0;
    z-index: 1;
  }
  
  .imports-container {
    margin-top: 1rem;
  }
  
  .imports-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
  }
  
  .imports-table th {
    background: #f5f5f5;
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 500;
    border-bottom: 1px solid #eee;
  }
  
  .imports-table td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #eee;
  }
  
  .dll-name {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #1976d2;
  }
  
  .expand-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 4px;
    color: #666;
    transition: transform 0.2s;
  }
  
  .expand-btn:hover {
    background: #f5f5f5;
  }
  
  .expand-btn.expanded {
    transform: rotate(180deg);
  }
  
  .details-row {
    background: #f9f9f9;
  }
  
  .function-details {
    padding: 0 !important;
  }
  
  .function-list {
    padding: 1rem;
    max-height: 300px;
    overflow-y: auto;
  }
  
  .function-item {
    display: flex;
    gap: 1rem;
    padding: 0.5rem;
    border-bottom: 1px solid #eee;
  }
  
  .function-item:last-child {
    border-bottom: none;
  }
  
  .function-address {
    color: #666;
    font-family: monospace;
    min-width: 100px;
  }
  
  .function-name {
    font-family: monospace;
    color: #333;
  }
  
  .strings-container {
    border: 1px solid #eee;
    border-radius: 4px;
  }
  
  .strings-tabs {
    display: flex;
    border-bottom: 1px solid #eee;
  }
  
  .strings-tabs button {
    padding: 0.75rem 1.5rem;
    border: none;
    background: none;
    cursor: pointer;
    color: #666;
  }
  
  .strings-tabs button.active {
    color: #1976d2;
    border-bottom: 2px solid #1976d2;
  }
  
  .strings-content {
    max-height: 400px;
    overflow-y: auto;
    padding: 1rem;
  }
  
  .string-item {
    padding: 0.5rem;
    font-family: monospace;
    border-bottom: 1px solid #eee;
  }
  
  .string-item:last-child {
    border-bottom: none;
  }
  
  .section-header-with-icon {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    color: #1976d2;
    position: relative;
  }
  
  .section-header-with-icon .section-title {
    margin-bottom: 0;
    color: #333;
  }
  
  .section-header-with-icon .expand-icon {
    position: absolute;
    right: 0;
  }
  
  .sections-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
  }
  
  .sections-table th {
    background: #f5f5f5;
    font-weight: 500;
    position: sticky;
    top: 0;
    z-index: 1;
    padding: 1rem;
    text-align: left;
    border-bottom: 2px solid #e3f2fd;
  }
  
  .sections-table td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #eee;
  }
  
  .dll-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: #f5f5f5;
    color: #1976d2;
  }
  
  .function-divider {
    position: absolute;
    bottom: 0;
    left: 1rem;
    right: 1rem;
    height: 1px;
    background: linear-gradient(to right, #e3f2fd, transparent);
  }
  
  .import-function {
    position: relative;
    padding: 0.75rem 1rem;
  }
  
  .string-item {
    position: relative;
    padding: 0.75rem 1rem;
  }
  
  .string-divider {
    position: absolute;
    bottom: 0;
    left: 1rem;
    right: 1rem;
    height: 1px;
    background: linear-gradient(to right, #e3f2fd, transparent);
  }
  
  .strings-tabs button.active {
    color: #1976d2;
    border-bottom: 2px solid #1976d2;
    font-weight: 500;
  }
  
  .dropdown-container {
    position: relative;
    display: inline-block;
  }
  
  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    min-width: 160px;
    padding: 0.5rem 0;
    margin: 0.125rem 0 0;
    background-color: white;
    border: 1px solid #eee;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }
  
  .dropdown-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
    padding: 0.5rem 1rem;
    border: none;
    background: none;
    cursor: pointer;
    text-align: left;
    white-space: nowrap;
    color: #333;
  }
  
  .dropdown-item:hover {
    background-color: #f5f5f5;
  }
  
  .detection-section {
    padding: 1rem;
  }
  
  .section-header {
    margin-bottom: 1rem;
  }
  
  .section-header h3 {
    font-size: 1.1rem;
    font-weight: 500;
  }
  
  .sigma-table-container {
    overflow-x: auto;
  }
  
  .sigma-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
  }
  
  .sigma-table th {
    background: #f5f5f5;
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 500;
    border-bottom: 1px solid #eee;
  }
  
  .sigma-table td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #eee;
    vertical-align: top;
  }
  
  .tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
  }
  
  .tag {
    background: #e3f2fd;
    color: #1976d2;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .level-tag {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: 500;
  }
  
  .level-tag.critical {
    background: #ffebee;
    color: #d32f2f;
  }
  
  .level-tag.high {
    background: #fff3e0;
    color: #ef6c00;
  }
  
  .level-tag.medium {
    background: #fff8e1;
    color: #f57f17;
  }
  
  .level-tag.low {
    background: #f1f8e9;
    color: #689f38;
  }
  
  .matches-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: none;
    border: none;
    cursor: pointer;
    color: #1976d2;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
  }
  
  .matches-btn:hover {
    background: #f5f5f5;
  }
  
  .matches-row {
    background: #fafafa;
  }
  
  .matches-details {
    padding: 1rem;
  }
  
  .match-item {
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
    margin-bottom: 0.5rem;
  }
  
  .match-item:last-child {
    margin-bottom: 0;
  }
  
  .match-header {
    padding: 0.5rem 1rem;
    background: #f5f5f5;
    border-bottom: 1px solid #eee;
    font-weight: 500;
  }
  
  .match-content {
    padding: 1rem;
  }
  
  .match-field {
    margin-bottom: 0.5rem;
  }
  
  .match-field:last-child {
    margin-bottom: 0;
  }
  
  .field-label {
    color: #666;
    margin-right: 0.5rem;
  }
  
  .field-value {
    font-family: monospace;
    word-break: break-all;
  }
  
  .environment-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
  }
  
  .environment-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background: #e3f2fd;
    color: #1976d2;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .yara-table-container {
    margin-bottom: 2rem;
  }
  
  .behavior-section {
    margin-bottom: 2rem;
  }
  
  .header-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .icon-danger {
    color: #d32f2f;
  }
  
  .icon-warning {
    color: #f57c00;
  }
  
  .icon-info {
    color: #1976d2;
  }
  
  .behavior-list {
    margin-top: 1rem;
  }
  
  .behavior-item {
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
    margin-bottom: 0.5rem;
  }
  
  .behavior-item.danger {
    border-left: 4px solid #d32f2f;
  }
  
  .behavior-item.warning {
    border-left: 4px solid #f57c00;
  }
  
  .behavior-item.info {
    border-left: 4px solid #1976d2;
  }
  
  .behavior-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    cursor: pointer;
  }
  
  .behavior-header:hover {
    background: #f5f5f5;
  }
  
  .behavior-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }
  
  .behavior-name {
    font-weight: 500;
  }
  
  .behavior-tag {
    background: #e3f2fd;
    color: #1976d2;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .attck-tag {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    background: #fff3e0;
    color: #e65100;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
  }
  
  .behavior-details {
    padding: 1rem;
    border-top: 1px solid #eee;
    background: #fafafa;
  }
  
  .attck-info {
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
    margin-bottom: 1rem;
  }
  
  .attck-header {
    padding: 0.75rem 1rem;
    font-weight: 500;
    background: #f5f5f5;
    border-bottom: 1px solid #eee;
  }
  
  .attck-content {
    padding: 1rem;
  }
  
  .attck-item {
    margin-bottom: 0.5rem;
  }
  
  .attck-item:last-child {
    margin-bottom: 0;
  }
  
  .attck-label {
    color: #666;
    margin-right: 0.5rem;
    font-weight: 500;
  }
  
  .marks-container {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .mark-item {
    background: white;
    border: 1px solid #eee;
    border-radius: 4px;
  }
  
  .mark-header {
    padding: 0.75rem 1rem;
    font-weight: 500;
    background: #f5f5f5;
    border-bottom: 1px solid #eee;
  }
  
  .mark-content {
    padding: 1rem;
  }
  
  .mark-field {
    margin-bottom: 0.5rem;
  }
  
  .mark-field:last-child {
    margin-bottom: 0;
  }
  
  .field-label {
    color: #666;
    margin-right: 0.5rem;
  }
  
  .field-value {
    font-family: monospace;
    word-break: break-all;
  }
  </style> 